"use strict";function _typeof(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var i;try{i=require("jquery")}catch(e){i=null}module.exports=t(i)}else window&&(window.Slider=t(window.jQuery))}(function(t){var i;return function(t){function i(){}function e(t){function e(i){i.prototype.option||(i.prototype.option=function(i){t.isPlainObject(i)&&(this.options=t.extend(!0,this.options,i))})}function o(i,e){t.fn[i]=function(o){if("string"==typeof o){for(var a=s.call(arguments,1),h=0,l=this.length;h<l;h++){var r=this[h],p=t.data(r,i);if(p)if(t.isFunction(p[o])&&"_"!==o.charAt(0)){var d=p[o].apply(p,a);if(void 0!==d&&d!==p)return d}else n("no such method '"+o+"' for "+i+" instance");else n("cannot call methods on "+i+" prior to initialization; attempted to call '"+o+"'")}return this}var c=this.map(function(){var s=t.data(this,i);return s?(s.option(o),s._init()):(s=new e(this,o),t.data(this,i,s)),t(this)});return!c||c.length>1?c:c[0]}}if(t){var n="undefined"==typeof console?i:function(t){console.error(t)};return t.bridget=function(t,i){e(i),o(t,i)},t.bridget}}var s=Array.prototype.slice;e(t)}(t),function(t){function e(i,e){function s(t,i){var e="data-slider-"+i.replace(/_/g,"-"),s=t.getAttribute(e);try{return JSON.parse(s)}catch(o){return s}}this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1},"string"==typeof i?this.element=document.querySelector(i):i instanceof HTMLElement&&(this.element=i),e=e?e:{};for(var n=Object.keys(this.defaultOptions),a=0;a<n.length;a++){var h=n[a],l=e[h];l="undefined"!=typeof l?l:s(this.element,h),l=null!==l?l:this.defaultOptions[h],this.options||(this.options={}),this.options[h]=l}"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.tooltip_position="right";var r,p,d,c,u,m=this.element.style.width,_=!1,v=this.element.parentNode;if(this.sliderElem)_=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var f=document.createElement("div");f.className="slider-track",p=document.createElement("div"),p.className="slider-track-low",r=document.createElement("div"),r.className="slider-selection",d=document.createElement("div"),d.className="slider-track-high",c=document.createElement("div"),c.className="slider-handle min-slider-handle",c.setAttribute("role","slider"),c.setAttribute("aria-valuemin",this.options.min),c.setAttribute("aria-valuemax",this.options.max),u=document.createElement("div"),u.className="slider-handle max-slider-handle",u.setAttribute("role","slider"),u.setAttribute("aria-valuemin",this.options.min),u.setAttribute("aria-valuemax",this.options.max),f.appendChild(p),f.appendChild(r),f.appendChild(d);var g=Array.isArray(this.options.labelledby);if(g&&this.options.labelledby[0]&&c.setAttribute("aria-labelledby",this.options.labelledby[0]),g&&this.options.labelledby[1]&&u.setAttribute("aria-labelledby",this.options.labelledby[1]),!g&&this.options.labelledby&&(c.setAttribute("aria-labelledby",this.options.labelledby),u.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&this.options.ticks.length>0){for(a=0;a<this.options.ticks.length;a++){var y=document.createElement("div");y.className="slider-tick",this.ticks.push(y),f.appendChild(y)}r.className+=" tick-slider-selection"}if(f.appendChild(c),f.appendChild(u),this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&this.options.ticks_labels.length>0)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",a=0;a<this.options.ticks_labels.length;a++){var b=document.createElement("div"),k=0===this.options.ticks_positions.length,E=this.options.reversed&&k?this.options.ticks_labels.length-(a+1):a;b.className="slider-tick-label",b.innerHTML=this.options.ticks_labels[E],this.tickLabels.push(b),this.tickLabelContainer.appendChild(b)}var x=function(t){var i=document.createElement("div");i.className="tooltip-arrow";var e=document.createElement("div");e.className="tooltip-inner",t.appendChild(i),t.appendChild(e)},C=document.createElement("div");C.className="tooltip tooltip-main",C.setAttribute("role","presentation"),x(C);var w=document.createElement("div");w.className="tooltip tooltip-min",w.setAttribute("role","presentation"),x(w);var L=document.createElement("div");L.className="tooltip tooltip-max",L.setAttribute("role","presentation"),x(L),this.sliderElem.appendChild(f),this.sliderElem.appendChild(C),this.sliderElem.appendChild(w),this.sliderElem.appendChild(L),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),v.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),o[this.options.scale]&&(this.options.scale=o[this.options.scale]),_===!0&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","top","width","height"].forEach(function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=m,this.options.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&this.options.ticks.length>0&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=p||this.trackLow,this.trackSelection=r||this.trackSelection,this.trackHigh=d||this.trackHigh,"none"===this.options.selection&&(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")),this.handle1=c||this.handle1,this.handle2=u||this.handle2,_===!0)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),a=0;a<this.ticks.length;a++)this._removeClass(this.ticks[a],"round triangle hide");var P=["round","triangle","custom"],T=P.indexOf(this.options.handle)!==-1;if(T)for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),a=0;a<this.ticks.length;a++)this._addClass(this.ticks[a],this.options.handle);this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchCapable&&this.sliderElem.addEventListener("touchstart",this.mousedown,!1),this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)),this.options.enabled?this.enable():this.disable()}var s={formatInvalidInputErrorMsg:function(t){return"Invalid input value '"+t+"' passed in"},callingContextNotSliderInstance:"Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"},o={linear:{toValue:function(t){var i=t/100*(this.options.max-this.options.min),e=!0;if(this.options.ticks_positions.length>0){for(var s,o,n,a=0,h=1;h<this.options.ticks_positions.length;h++)if(t<=this.options.ticks_positions[h]){s=this.options.ticks[h-1],n=this.options.ticks_positions[h-1],o=this.options.ticks[h],a=this.options.ticks_positions[h];break}var l=(t-n)/(a-n);i=s+l*(o-s),e=!1}var r=e?this.options.min:0,p=r+Math.round(i/this.options.step)*this.options.step;return p<this.options.min?this.options.min:p>this.options.max?this.options.max:p},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(this.options.ticks_positions.length>0){for(var i,e,s,o=0,n=0;n<this.options.ticks.length;n++)if(t<=this.options.ticks[n]){i=n>0?this.options.ticks[n-1]:0,s=n>0?this.options.ticks_positions[n-1]:0,e=this.options.ticks[n],o=this.options.ticks_positions[n];break}if(n>0){var a=(t-i)/(e-i);return s+a*(o-s)}}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var i=0===this.options.min?0:Math.log(this.options.min),e=Math.log(this.options.max),s=Math.exp(i+(e-i)*t/100);return s=this.options.min+Math.round((s-this.options.min)/this.options.step)*this.options.step,s<this.options.min?this.options.min:s>this.options.max?this.options.max:s},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var i=Math.log(this.options.max),e=0===this.options.min?0:Math.log(this.options.min),s=0===t?0:Math.log(t);return 100*(s-e)/(i-e)}}};if(i=function(t,i){return e.call(this,t,i),this},i.prototype={_init:function(){},constructor:i,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,scale:"linear",focus:!1,tooltip_position:null,labelledby:null},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,i,e){t||(t=0);var s=this.getValue();this._state.value=this._validateInputValue(t);var o=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=o(this._state.value[0]),this._state.value[1]=o(this._state.value[1]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=o(this._state.value),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();var n=this.options.range?this._state.value:this._state.value[0];return this._setDataVal(n),i===!0&&this._trigger("slide",n),s!==n&&e===!0&&this._trigger("change",{oldValue:s,newValue:n}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,i){return this._bindNonQueryEventHandler(t,i),this},off:function(i,e){t?(this.$element.off(i,e),this.$sliderElem.off(i,e)):this._unbindNonQueryEventHandler(i,e)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,i){return this.options[t]=i,this},refresh:function(){return this._removeSliderEventHandlers(),e.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},relayout:function(){return this._layout(),this},_removeSliderEventHandlers:function(){this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.showTooltip&&(this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle2.removeEventListener("focus",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("blur",this.hideTooltip,!1)),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.mousedown,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,i){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(i)},_unbindNonQueryEventHandler:function(t,i){var e=this.eventToCallbackMap[t];if(void 0!==e)for(var s=0;s<e.length;s++)if(e[s]===i){e.splice(s,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),i=0;i<t.length;i++){var e=t[i];this.eventToCallbackMap[e]=null}},_showTooltip:function(){this.options.tooltip_split===!1?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){this._state.inDrag===!1&&this.alwaysShowTooltip!==!0&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this._state.over=!1},_layout:function(){var t;if(t=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),this.handle2.style[this.stylePos]=t[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),Array.isArray(this.options.ticks)&&this.options.ticks.length>0){var i="vertical"===this.options.orientation?"height":"width",e="vertical"===this.options.orientation?"marginTop":"marginLeft",s=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var o=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[e]=-s/2+"px"),o=this.tickLabelContainer.offsetHeight;else for(n=0;n<this.tickLabelContainer.childNodes.length;n++)this.tickLabelContainer.childNodes[n].offsetHeight>o&&(o=this.tickLabelContainer.childNodes[n].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=o+"px")}for(var n=0;n<this.options.ticks.length;n++){var a=this.options.ticks_positions[n]||this._toPercentage(this.options.ticks[n]);this.options.reversed&&(a=100-a),this.ticks[n].style[this.stylePos]=a+"%",this._removeClass(this.ticks[n],"in-selection"),this.options.range?a>=t[0]&&a<=t[1]&&this._addClass(this.ticks[n],"in-selection"):"after"===this.options.selection&&a>=t[0]?this._addClass(this.ticks[n],"in-selection"):"before"===this.options.selection&&a<=t[0]&&this._addClass(this.ticks[n],"in-selection"),this.tickLabels[n]&&(this.tickLabels[n].style[i]=s+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[n]?(this.tickLabels[n].style.position="absolute",this.tickLabels[n].style[this.stylePos]=a+"%",this.tickLabels[n].style[e]=-s/2+"px"):"vertical"===this.options.orientation&&(this.tickLabels[n].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style.marginTop=this.sliderElem.offsetWidth/2*-1+"px"))}}var h;if(this.options.range){h=this.options.formatter(this._state.value),this._setText(this.tooltipInner,h),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),"vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px");var l=this.options.formatter(this._state.value[0]);this._setText(this.tooltipInner_min,l);var r=this.options.formatter(this._state.value[1]);this._setText(this.tooltipInner_max,r),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-top",-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-left",-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-top",-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-left",-this.tooltip_max.offsetWidth/2+"px")}else h=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,h),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px");if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(t[0],t[1])+"%",this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";else{this.trackLow.style.left="0",this.trackLow.style.width=Math.min(t[0],t[1])+"%",this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";var p=this.tooltip_min.getBoundingClientRect(),d=this.tooltip_max.getBoundingClientRect();"bottom"===this.options.tooltip_position?p.right>d.left?(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):p.right>d.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,i){t.style.removeProperty?t.style.removeProperty(i):t.style.removeAttribute(i)},_mousedown:function(t){if(!this._state.enabled)return!1;this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var i=this._getPercentage(t);if(this.options.range){var e=Math.abs(this._state.percentage[0]-i),s=Math.abs(this._state.percentage[1]-i);this._state.dragged=e<s?0:1}else this._state.dragged=0;this._state.percentage[this._state.dragged]=i,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;var o=this._calculateValue();return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!1,!0),this._pauseEvent(t),this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,i){if(!this._state.enabled)return!1;var e;switch(i.keyCode){case 37:case 40:e=-1;break;case 39:case 38:e=1}if(e){if(this.options.natural_arrow_keys){var s="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed;(s||o)&&(e=-e)}var n=this._state.value[t]+e*this.options.step;return this.options.range&&(n=[t?this._state.value[0]:n,t?n:this._state.value[1]]),this._trigger("slideStart",n),this._setDataVal(n),this.setValue(n,!0,!0),this._setDataVal(n),this._trigger("slideStop",n),this._layout(),this._pauseEvent(i),!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;var i=this._getPercentage(t);this._adjustPercentageForRangeSliders(i),this._state.percentage[this._state.dragged]=i,this._layout();var e=this._calculateValue(!0);return this.setValue(e,!0,!0),!1},_adjustPercentageForRangeSliders:function(t){if(this.options.range){var i=this._getNumDigitsAfterDecimalPlace(t);i=i?i-1:0;var e=this._applyToFixedAndParseFloat(t,i);0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],i)<e?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],i)>e&&(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0)}},_mouseup:function(){if(!this._state.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!1,this._state.over===!1&&this._hideTooltip();var t=this._calculateValue(!0);return this._layout(),this._setDataVal(t),this._trigger("slideStop",t),!1},_calculateValue:function(t){var i;if(this.options.range?(i=[this.options.min,this.options.max],0!==this._state.percentage[0]&&(i[0]=this._toValue(this._state.percentage[0]),i[0]=this._applyPrecision(i[0])),100!==this._state.percentage[1]&&(i[1]=this._toValue(this._state.percentage[1]),i[1]=this._applyPrecision(i[1]))):(i=this._toValue(this._state.percentage[0]),i=parseFloat(i),i=this._applyPrecision(i)),t){for(var e=[i,1/0],s=0;s<this.options.ticks.length;s++){var o=Math.abs(this.options.ticks[s]-i);o<=e[1]&&(e=[this.options.ticks[s],o])}if(e[1]<=this.options.ticks_snap_bounds)return e[0]}return i},_applyPrecision:function(t){var i=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,i)},_getNumDigitsAfterDecimalPlace:function(t){var i=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return i?Math.max(0,(i[1]?i[1].length:0)-(i[2]?+i[2]:0)):0},_applyToFixedAndParseFloat:function(t,i){var e=t.toFixed(i);return parseFloat(e)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var i=t[this.mousePos],e=this._state.offset[this.stylePos],s=i-e,o=s/this._state.size*100;return o=Math.round(o/this._state.percentage[2])*this._state.percentage[2],this.options.reversed&&(o=100-o),Math.max(0,Math.min(100,o))},_validateInputValue:function(t){if("number"==typeof t)return t;if(Array.isArray(t))return this._validateArray(t),t;throw new Error(s.formatInvalidInputErrorMsg(t))},_validateArray:function(t){for(var i=0;i<t.length;i++){var e=t[i];if("number"!=typeof e)throw new Error(s.formatInvalidInputErrorMsg(e))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(i,e){e=e||0===e?e:void 0;var s=this.eventToCallbackMap[i];if(s&&s.length)for(var o=0;o<s.length;o++){var n=s[o];n(e)}t&&this._triggerJQueryEvent(i,e)},_triggerJQueryEvent:function(t,i){var e={type:t,value:i};this.$element.trigger(e),this.$sliderElem.trigger(e)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,i){"undefined"!=typeof t.textContent?t.textContent=i:"undefined"!=typeof t.innerText&&(t.innerText=i)},_removeClass:function(t,i){for(var e=i.split(" "),s=t.className,o=0;o<e.length;o++){var n=e[o],a=new RegExp("(?:\\s|^)"+n+"(?:\\s|$)");s=s.replace(a," ")}t.className=s.trim()},_addClass:function(t,i){for(var e=i.split(" "),s=t.className,o=0;o<e.length;o++){var n=e[o],a=new RegExp("(?:\\s|^)"+n+"(?:\\s|$)"),h=a.test(s);h||(s+=" "+n)}t.className=s.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetTop:function(t){for(var i=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)i+=t.offsetTop,"BODY"!==t.tagName&&(i-=t.scrollTop);return i},_offset:function(t){return{left:this._offsetLeft(t),top:this._offsetTop(t)}},_css:function(i,e,s){if(t)t.style(i,e,s);else{var o=e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,i){return i.toUpperCase()});i.style[o]=s}},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var t=[this.tooltip,this.tooltip_min,this.tooltip_max];if("vertical"===this.options.orientation){var i=this.options.tooltip_position||"right",e="left"===i?"right":"left";t.forEach(function(t){this._addClass(t,i),t.style[e]="100%"}.bind(this))}else"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))}},t){var n=t.fn.slider?"bootstrapSlider":"slider";t.bridget(n,i),t(function(){t("input[data-provide=slider]")[n]()})}}(t),i});
(function(){var t,i;t=this.jQuery||window.jQuery,i=t(window),t.fn.stick_in_parent=function(o){var e,s,r,n,l,a,c,p,d,u,f,h,g;for(null==o&&(o={}),g=o.sticky_class,a=o.inner_scrolling,h=o.recalc_every,f=o.parent,d=o.offset_top,p=o.spacer,r=o.bottoming,null==d&&(d=0),null==f&&(f=void 0),null==a&&(a=!0),null==g&&(g="is_stuck"),e=t(document),null==r&&(r=!0),u=function(t){var i,o,e;return window.getComputedStyle?(i=t[0],o=window.getComputedStyle(t[0]),e=parseFloat(o.getPropertyValue("width"))+parseFloat(o.getPropertyValue("margin-left"))+parseFloat(o.getPropertyValue("margin-right")),"border-box"!==o.getPropertyValue("box-sizing")&&(e+=parseFloat(o.getPropertyValue("border-left-width"))+parseFloat(o.getPropertyValue("border-right-width"))+parseFloat(o.getPropertyValue("padding-left"))+parseFloat(o.getPropertyValue("padding-right"))),e):t.outerWidth(!0)},n=function(o,s,n,l,c,y,k,m){var v,b,w,_,x,P,V,F,C,z,I,A;if(!o.data("sticky_kit")){if(o.data("sticky_kit",!0),x=e.height(),V=o.parent(),null!=f&&(V=V.closest(f)),!V.length)throw"failed to find stick parent";if(w=!1,v=!1,I=null!=p?p&&o.closest(p):t("<div />"),I&&I.css("position",o.css("position")),F=function(){var t,i,r;if(!m)return x=e.height(),t=parseInt(V.css("border-top-width"),10),i=parseInt(V.css("padding-top"),10),s=parseInt(V.css("padding-bottom"),10),n=V.offset().top+t+i,l=V.height(),w&&(w=!1,v=!1,null==p&&(o.insertAfter(I),I.detach()),o.css({position:"",top:"",width:"",bottom:""}).removeClass(g),r=!0),c=o.offset().top-(parseInt(o.css("margin-top"),10)||0)-d,y=o.outerHeight(!0),k=o.css("float"),I&&I.css({width:u(o),height:y,display:o.css("display"),"vertical-align":o.css("vertical-align"),"float":k}),r?A():void 0},F(),y!==l)return _=void 0,P=d,z=h,A=function(){var t,u,f,b,C,A;if(!m)return f=!1,null!=z&&(z-=1,z<=0&&(z=h,F(),f=!0)),f||e.height()===x||(F(),f=!0),b=i.scrollTop(),null!=_&&(u=b-_),_=b,w?(r&&(C=b+y+P>l+n,v&&!C&&(v=!1,o.css({position:"fixed",bottom:"",top:P}).trigger("sticky_kit:unbottom"))),b<c&&(w=!1,P=d,null==p&&("left"!==k&&"right"!==k||o.insertAfter(I),I.detach()),t={position:"",width:"",top:""},o.css(t).removeClass(g).trigger("sticky_kit:unstick")),a&&(A=i.height(),y+d>A&&(v||(P-=u,P=Math.max(A-y,P),P=Math.min(d,P),w&&o.css({top:P+"px"}))))):b>c&&(w=!0,t={position:"fixed",top:P},t.width="border-box"===o.css("box-sizing")?o.outerWidth()+"px":o.width()+"px",o.css(t).addClass(g),null==p&&(o.after(I),"left"!==k&&"right"!==k||I.append(o)),o.trigger("sticky_kit:stick")),w&&r&&(null==C&&(C=b+y+P>l+n),!v&&C)?(v=!0,"static"===V.css("position")&&V.css({position:"relative"}),o.css({position:"absolute",bottom:s,top:"auto"}).trigger("sticky_kit:bottom")):void 0},C=function(){return F(),A()},b=function(){if(m=!0,i.off("touchmove",A),i.off("scroll",A),i.off("resize",C),t(document.body).off("sticky_kit:recalc",C),o.off("sticky_kit:detach",b),o.removeData("sticky_kit"),o.css({position:"",bottom:"",top:"",width:""}),V.position("position",""),w)return null==p&&("left"!==k&&"right"!==k||o.insertAfter(I),I.remove()),o.removeClass(g)},i.on("touchmove",A),i.on("scroll",A),i.on("resize",C),t(document.body).on("sticky_kit:recalc",C),o.on("sticky_kit:detach",b),setTimeout(A,0)}},l=0,c=this.length;l<c;l++)s=this[l],n(t(s));return this}}).call(this);
var TB=TB||{};!function(){function e(e,n){function s(e){if(window){var r=e+"-practice",o=window.location.href||"",t=o.split("//").length&&o.split("//")[1]||"";window.location.search&&(t=t.split("?")[0]);var n=t.split("/");n.splice(0,1);var s=n[0],a=d+"-practice",i="";s===d?(n[0]=e,i="/"+n.join("/"),window.location.href=i):s===a?(i="/"+r,window.location.href=i):window.location.reload()}}function a(e){showLoader("Changing Course. Please wait.");var r=function(r){forceSessionRefresh(!0);var o={id:e.id||"",name:e.name||""};TB.UpdateCurrentCourseInStorage(o),s(e.url)},o=function(e){e?showAlert(e.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3),hideLoader()},t={course:e.id};n.setCurrentCourse(t,r,o)}var i="/tb-money",c={},u=$("#sid")&&$("#sid").val()||-1,l=Object.prototype.hasOwnProperty;this.tbCourseArr=JSON.parse($("#course_info")&&$("#course_info").val()||"[]"),this.showStuCourseDropdown=!0;var d=document.getElementById("curCourseURL")&&document.getElementById("curCourseURL").value||"";this.stuObj={isShowCoBrandingLogo:!1,coBrandingLogoSrc:"",currentCourseObj:{},enrollmentsArr:[],profilePic:"",isLoggedIn:isLoggedIn()||!1,tbMoney:0},this.updateCurrentCourse=function(e){return a(e),!1};var g={},f=this,h=function(e){var r={id:e,name:g[e]&&g[e].abbr||"",url:g[e]&&g[e].URL||""};return r},p=function(e,r){for(var o=0;o<e.length;o++)if(e[o].course&&e[o].course.id==r)return o;return-1};e.$on(r,function(e,r){r&&(f.stuObj.currentCourseObj=h(r.courseId||""))}),e.$on(t,function(e,r){r&&(f.showStuCourseDropdown=!1)}),e.$on(o,function(e,r){if(r)if(r.isEnrolled){var o={course:h(r.courseId||"")};Object.keys(o).length&&f.stuObj.enrollmentsArr.push(o)}else{var t=p(f.stuObj.enrollmentsArr,r.courseId||"");t!==-1&&f.stuObj.enrollmentsArr.splice(t,1)}});var b=function(e){for(var r={},o=0;o<e.length;o++)if(e[o].isGroup)for(var t=0;t<e[o].courses.length;t++)r[e[o].courses[t].id]=e[o].courses[t];else r[e[o].id]=e[o];return r},O=function(e){for(var r=[],o=0;o<e.length;o++)g[e[o].course.id]&&(e[o].course.url=g[e[o].course.id].URL,e[o].course.hasOwnProperty("isInactive")&&e[o].course.isInactive||r.push(e[o]));return r};this.isShowNav=function(e){return e!==i||this.stuObj&&0!==this.stuObj.tbMoney};var m=function(){var e=function(e){if(e.hasOwnProperty("message"))showAlert(e.message||"Something went wrong please contact at support@testbook.com","error","small",5e3);else{c=e.data||{};var r=l.call(c,"streaks")&&l.call(c.streaks,"practise")&&l.call(c.streaks.practise,"coins"),o=l.call(c,"streaks")&&l.call(c.streaks,"questions")&&l.call(c.streaks.questions,"coins");l.call(c,"cobrandingInfo")&&c.cobrandingInfo.logo&&(f.stuObj.coBrandingLogoSrc=c.cobrandingInfo.logo,f.stuObj.isShowCoBrandingLogo=!0),l.call(c,"currentCourse")&&c.currentCourse.id&&(f.stuObj.currentCourseObj=c.currentCourse),l.call(c,"image")&&c.image&&(f.stuObj.profilePic=c.image),l.call(c,"enrollments")&&c.enrollments.length&&(f.stuObj.enrollmentsArr=O(c.enrollments)),l.call(c,"referral")&&l.call(c.referral,"coins")&&(f.stuObj.tbMoney+=c.referral.coins),r&&(f.stuObj.tbMoney+=c.streaks.practise.coins),o&&(f.stuObj.tbMoney+=c.streaks.questions.coins),l.call(c,"coinsExpensed")&&(f.stuObj.tbMoney-=c.coinsExpensed),l.call(c,"referral")&&(f.stuObj.referral=c.referral)}};g=b(f.tbCourseArr),"-1"!=u&&TB.GetStudentFromStorage(e)};angular.element(document).ready(function(){$(".js-group-one, #js-header-options-sidebar .course-btn").click(function(e){e.stopPropagation(),e.preventDefault(),$(this).toggleClass("active"),$(this).parent().children("ul").slideToggle()})}),m()}var r="COURSE_CHANGED",o="COURSE_ENROLLED_DE_ENROLLED",t="REMOVE_STU_COURSE_DROPDOWN",n=angular.module("tbHeaderApp",["Testbook"]);n.controller("headerCtrl",["$scope","TB",e])}();
var TB=TB||{};!function(){function e(){return{restrict:"E",scope:{},controller:["$scope","TB",t],templateUrl:"/views/partials/components/subfooter-seo.html"}}function t(e,t){var o=function(){return{anchorTag:"",link:""}},n=function(){return{title:"",links:[]}},s=function(){return{id:"",URL:"",type:"",name:"",sections:[],SEO:{title:"",description:"",keywords:[],URL:"",rel:[]}}},r="absent",i=window.location.host+window.location.pathname,a="ls_seo",c={};e.isSubFooterPresent=!1,e.subFooterSections=[];var l=function(e){for(var t=[],s=0;s<e.length;s++){var r=n();r.title=e[s].title||"";for(var i=0;i<e[s].links.length;i++){var a=o();a.link=e[s].links[i].link||"",a.anchorTag=e[s].links[i].anchorTag||"",r.links.push(a)}t.push(r)}return t},u=function(){var o=function(t){if(t.data.hasOwnProperty("id")&&""!==t.data.id){t=t.data;var o=s();o.id=t.id,o.URL=t.URL||"",o.type=t.pageType||"",o.name=t.name||"",o.sections=l(t.sections||[]),e.subFooterSections=o.sections,e.subFooterSections.length&&(e.isSubFooterPresent=!0),c[i]=o,setLocalStorage(a,JSON.stringify(c),.5)}},n=function(e){e&&e.message&&e.message.indexOf("SEO does not exists")!==-1&&(c[i]=r,setLocalStorage(a,JSON.stringify(c),.5))};if(c=JSON.parse(getLocalStorage(a)||"{}"),c.hasOwnProperty(i))c.PAGE_URL!==r?(e.subFooterSections=c[i].sections||[],e.subFooterSections.length&&(e.isSubFooterPresent=!0)):c.PAGE_URL===r&&(e.isSubFooterPresent=!1);else{var u={url:i,fields:"URL,name,pageType,sections"};t.getPageSEO(u,o,n)}};u()}var o=angular.module("SEO",["Testbook"]);o.directive("subFooter",e)}();
"use strict";var productCardModule=angular.module("productCardModule",[]);productCardModule.service("productCardService",["subscriptionService","$timeout",function(e,t){var s=new Date("0001-01-01T00:00:00Z").getTime(),i="",r="",a=(new Date).getTime(),o={},n=!1,c=!1,d=0,u={},l={},h=0,m={},f={combo:"combo",pack:"pack"},g={},p={},T={},v={},C=[],y={},P={},b={};this.setAllTestsObj=function(e){b=e||""},this.setCurrentCourseUrl=function(e){i=e||""},this.setMapPidToProcessedProduct=function(e){y=e||""},this.setTestsOfExpiredProducts=function(e){C=e||""},this.setPurchasedSubsMap=function(e){v=e||""},this.setTimerForCurrentTime=function x(e){a=e+1e3,t(function(){x(e)},1e3)},this.setAllCategoryMap=function(e){o=e||""},this.setPromotionsPageBool=function(e){n=e||""},this.setSubscriptionStatus=function(e){c=e||""},this.setRemainingCoins=function(e){d=e||""},this.setPidToItemsMap=function(e){u=e||""},this.setPidToProductMap=function(e){l=e||""},this.setMyTestsIdObjMAP=function(e){m=e||""},this.setCoinsPercentage=function(e){h=e||""},this.setResumableTestMap=function(e){g=e||""},this.setSubsArrMap=function(e){p=e||""},this.setCourseIdToExpiryMap=function(e){T=e||""},this.setCurrentCourseId=function(e){r=e||""},this.getCurrentTime=function(){return a},this.checkForLiveTest=function(e){var t=new Date(e).getTime();return t>s},this.checkForPrelaunchTest=function(e,t){var s=new Date(e);return t=t?new Date(t):new Date,s>t},this.getLiveTestTime=function(e){return e.endTimeLive-e.startTimeLive>=60*e.pattern.time*1e3},this.getSpecificExamNamesArr=function(e){var t,s=validateArr(e),i=[];for(t=0;t<s.length;t+=1)i.indexOf(s[t])===-1&&i.push(s[t].name||s[t].title||"");return i},this.getTestDetailsObj=function(e){var t,s,i=validateArr(e),r={questionsCount:0,testsCount:i.length,time:0,marks:0};for(t=0;t<i.length;t+=1)s=i[t].pattern||{},r.questionsCount+=this.getQuestionsCount(s&&s.sections,"qCount"),r.time+=s.time||0,r.marks+=this.getQuestionsCount(s.sections,"maxM");return r},this.getQuestionsCount=function(e,t){var s,i=validateArr(e),r=0;for(s=0;s<i.length;s+=1)r+=i[s][t];return r},this.getProcessedTestObj=function(e){return e.items?this.getPaidTest(e):this.getFreeTest(e)},this.getProcessedPackObj=function(e,t){var s=this.checkForComboPack(e);return s||t!==f.pack?s&&t===f.combo?this.getProcessedCombo(e):{}:this.getProcessedPack(e)},this.getFreeTest=function(e){var t=e,r={};return t.isLiveTest=this.checkForLiveTest(t.info&&(t.info.startTime||s)),t.analysisURLQuiz="/"+i+"/quizzes/"+(t.id||t._id)+"/analysis",t.startURLQuiz="/"+i+"/quizzes/"+(t.id||t._id),t.solutionURL=t.isLiveTest?"/"+i+"/tests/"+(t.id||t._id)+"/promotions":"/"+i+"/tests/"+(t.id||t._id)+"#/solutions",t.analysisURL=t.isLiveTest?"/"+i+"/tests/"+(t.id||t._id)+"/promotions?from=analysis":"/"+i+"/tests/"+(t.id||t._id)+"/analysis",r.id=t.id||t._id,r.isPreLaunch=this.checkForPrelaunchTest(t.availFrom,a),r.availFrom=new Date(t.availFrom).getTime()||s,r.availTill=new Date(t.availTill).getTime()||s,r.testExpiryInDays=getDaysDiff(r.availTill,(new Date).getTime()),r.category=t.category,r.categoryObj=o[t.category]||"",r.description=t.description||"",r.pattern=t.pattern||{},r.isLiveTest=t.isLiveTest,r.startTimeLive=new Date(t.info&&t.info.startTime).getTime()||s,r.endTimeLive=new Date(t.info&&t.info.endTime).getTime()||s,r.isLongLiveTest=this.getLiveTestTime(r),r.title=t.title||"",r.cost=t.cost||0,r.specificExams=this.getSpecificExamNamesArr(t.specificExams)||[],r.specificExamsDL=t.specificExams||[],r.cardClass=this.getNonProductCardClass(r,a),r.itemsCount=1,r.offerText=t.cost?"":"FREE",r.course=t.course?t.course.name:"",r.testDetails=this.getTestDetailsObj([t]),r.type=t.type||"others",r.solutionURL=t.solutionURL,r.analysisURL=t.analysisURL,r.analysisURLQuiz=t.analysisURLQuiz,r.startURLQuiz=t.startURLQuiz,r.isShow=!0,r.isHide=!1,r.isPartOfHiddenProduct=r.isHide,r.showAdmitCardExams=t.showAdmitCardExams||[],t.servesOn=isValidDate(t.servesOn)?t.servesOn:s,r.isQuiz=t.servesOn&&new Date(t.servesOn).getTime()>0,r.servesOn=new Date(t.servesOn).getTime(),r},this.getPaidTest=function(e){var t,r=e,n={};return t=r.items&&r.items.length&&(r.items[0].id||""),r.isLiveTest=this.checkForLiveTest(r.items[0].info.startTime||s),r.solutionURL=r.isLiveTest?"/"+i+"/tests/"+r.id+"/promotions":"/"+i+"/tests/"+t+"#/solutions",r.analysisURL=r.isLiveTest?"/"+i+"/tests/"+r.id+"/promotions?from=analysis":"/"+i+"/tests/"+t+"/analysis",n.id=r.id||r._id,n.isPreLaunch=this.checkForPrelaunchTest(r.items[0].availFrom),n.availFrom=new Date(r.releaseDate).getTime()||s,n.availTill=new Date(r.items[0].availTill).getTime()||s,n.testExpiryInDays=getDaysDiff(n.availTill,(new Date).getTime()),n.category=r.category,n.categoryObj=o[r.category]||"",n.description=r.description||"",n.pattern=r.pattern||{},n.isLiveTest=r.isLiveTest,n.startTimeLive=new Date(r.items[0].info.startTime).getTime()||s,n.endTimeLive=new Date(r.items[0].info&&r.items[0].info.endTime).getTime()||s,n.isLongLiveTest=this.getLiveTestTime(n),n.title=r.items[0].title||"",n.cost=r.cost||0,n.offerText=r.discountText||"",n.recommendedFor=r.recommendedFor||"",n.oldCost=r.oldCost||0,n.specificExams=this.getSpecificExamNamesArr(r.specificExams),n.specificExamsDL=r.specificExams||[],n.cardClass=this.getNonProductCardClass(n,a),n.itemsCount=r.items.length||0,n.offerText=0===r.cost?"FREE":r.discountText,n.course=r.course?r.course.name:"",n.testDetails=this.getTestDetailsObj(r.items),n.type=r.type||"others",n.items=r.items,n.solutionURL=r.solutionURL,n.analysisURL=r.analysisURL,n.isShow=!0,n.isHide=r.isHidden||!1,n.isPartOfHiddenProduct=r.isHidden||!1,n.showAdmitCardExams=r.showAdmitCardExams||[],n.specificExamObjArr=r.specificExams,n},this.getProcessedPack=function(e){var t=e.isHidden,i=this.getProcessedItems(e.items,t,e._id),r={};return r.id=e._id,r.items=i,r.categorizedSortedPackTests=this.getCompleteSortedCategorizedItemsArr(i,"test",!1,"asc"),r.availTill=new Date(e.availTill).getTime()||s,r.category=e.category,r.categoryObj=e.categoryObj||{},r.categoryOrder=e.categoryObj&&e.categoryObj.order||10,r.cost=e.cost||0,r.createdOn=e.createdOn,r.description=e.description||"",r.isCustom=e.isCustom||!1,r.minPrice=e.minPrice||0,r.oldCost=e.oldCost||0,r.availFrom=new Date(e.releaseDate).getTime(),r.specificExams=this.getSpecificExamNamesArr(e.specificExams)||[],r.specificExamsDL=e.specificExams||[],r.course=e.course?e.course.name:"",r.courses=e.courses||[],r.stage=e.stage,r.title=e.title||"",r.offerText=e.discountText,r.packDetails=this.getTestDetailsObj(i),r.type=e.type||"others",r.isCombo=!1,r.isHide=new Date(e.releaseDate)>new Date||e.isHidden,r.isShow=!r.isHide,r.cardClass=this.getProductCardClass(r,[],n),r},this.getProcessedCombo=function(e){var t=this.getAllTestsOfComboPacks(e.items),i={};return i.id=e._id,i.items=e.items,i.logoURL=e.courseLogo||"//storage.googleapis.com/testbook/products/default.svg",i.addedPids=this.getAddedPids(e.items),i.categorizedSortedPackTests=this.getCompleteSortedCategorizedItemsArr(t,"test",!1,"asc"),i.availTill=new Date(e.availTill).getTime()||s,i.category=e.category,i.categoryObj=e.categoryObj,i.categoryOrder=e.categoryObj&&e.categoryObj.order||10,i.cost=e.cost,i.createdOn=e.createdOn,i.description=e.description||"",i.isCustom=e.isCustom,i.minPrice=e.minPrice,i.oldCost=e.oldCost||0,i.availFrom=new Date(e.releaseDate).getTime(),i.specificExams=this.getSpecificExamNamesArr(e.specificExams)||[],i.specificExamsDL=e.specificExams||[],i.course=e.course?e.course.name:"",i.courses=e.courses||[],i.stage=e.stage,i.title=e.title||"",i.offerText="SAVE RS. "+(i.oldCost-i.cost),i.features=e.features||[],i.recommendedFor=e.recommendedFor||"",i.comboPackTests=t,i.comboPackDetails=this.getComboPackDetailsObj(t),i.type=e.type||"others",i.isCombo=!0,i.isHide=e.isHidden||!1,i.isShow=!i.isHide,i.isHighlight=e.isRecommended,i.cardClass=this.getProductCardClass(i,[],n),i},this.checkForComboPack=function(e){var t,s=e.items||[];for(t=0;t<s.length;t+=1)if("product"===s[t].type)return!0;return!1},this.getProcessedItems=function(e,t,s){var r,n=validateArr(e);for(r=0;r<n.length;r+=1)n[r]=this.getProcessedTestObj(n[r],i,a,o),n[r].testDetails=this.getTestDetailsObj([n[r]]),n[r].isPartOfHiddenProduct=t||!1,n[r].pid=s;return n},this.getAddedPids=function(e){var t,s=validateArr(e),i=[];for(t=0;t<s.length;t+=1)i.push(s[t].id);return i},this.getCompleteSortedCategorizedItemsArr=function(e,t,s,i){var r,a,n,c,d,u=[];for(r in o)if(o.hasOwnProperty(r)){for(n=o[r],d={categoryId:r,categoryName:n.name,categoryOrder:n.order,orderBy:n.sort,sortOrder:n.sortOrder,value:[]},c=0;c<e.length;c+=1)a=e[c],a&&r===a.category&&(a.categoryObj=n,d.value.push(e[c]));d.value.length&&(d.alreadyPurchasedTestCount=this.getAlreadyPurchasedTestCount(d.value,m)||0,d.remainingTestsCount=d.value.length-d.alreadyPurchasedTestCount,i?d.value=sortFunction(d.value,d.orderBy,"string",i):d.value=sortFunction(d.value,d.orderBy,"string",d.sortOrder),u.push(d))}return u},this.getAlreadyPurchasedTestCount=function(e,t){var s,i,r=0;for(s=0;s<e.length;s+=1)i=e[s].id,t[i]&&(r+=1);return r},this.getNonProductCardClass=function(e){var t=e.endTimeLive-a,s="";return e.offerText&&(s="has-offer"),e.cost||(s=s?s+" is-free":s+"is-free"),e.isLiveTest&&(s=s?s+" is-live":s+"is-live"),e.itemsCount>1&&(s=s?s+" test-pack":s+"test-pack"),e.isLongLiveTest&&(s=s?s+" has-more-window":s+"has-more-window"),e.isLiveTest&&t<0&&(s=s?s+" lt-time-over":s+"lt-time-over"),new Date(e.availTill).getTime()<a&&(s=s?s+" available":s+"available"),e.specificExams&&e.specificExams.length&&(s=s?s+" has-tags":s+"has-tags"),s},this.getProductCardClass=function(e,t,s){var i=validateArr(t),r=e.oldCost?"has-old-price":"";return e.offerText&&(r=r?r+" has-offer":r+"has-offer"),e.isHighlight&&(r=r?r+" complete-pack":r+"complete-pack"),e.specificExams&&e.specificExams.length&&(r=r?r+" has-tags":r+"has-tags"),e.isRecommended&&s&&(r=r?r+" is-recommended":r+"is-recommended"),e.isPartOfCart||i.indexOf(e.id)===-1||(r=r?r+" subset-already-added":r+"subset-already-added"),e.isPartOfCart&&(r=r?r+" added-to-cart":"added-to-cart"),c&&(r=r?r+" subs-active":r+"subs-active"),d&&d>=e.cost*h/100&&(r=r?r+" purchase-with-coins":r+"purchase-with-coins"),r},this.getClassForMyTests=function(e){var t="",s=e.startTimeLive-this.getCurrentTime(),i=e.endTimeLive-this.getCurrentTime();if(e.isLiveTest?(t="live-test-card",t+=s>MS_IN_ONE_DAY?" lt-default-state":s<=MS_IN_ONE_DAY&&s>0?" lt-default-state":s<=0&&i>=0?" lt-start-test":i<=0?" lt-time-over":" lt-default-state"):(t="fst-test-card",t+=e.isPreLaunch?" test-prelaunch":" nt-default-state"),e.description&&(t=t?t+" has-syll-info":str+"has-syll-info"),e.specificExams&&e.specificExams.length&&(t=t?t+" has-tags":t+"has-tags"),g[e.id]&&(t=t?t+" test-resumable":t+"test-resumable"),e&&e.sourceId){var a=(p[e.sourceId]||{},getDaysDiff(T[r].expiry,(new Date).getTime())),o=a>=0?"subs-active":"subs-expired";t=t?t+" "+o:o}return t},this.getAllTestsOfComboPacks=function(e){var t,s,r,n=validateArr(e),c=[];for(t=0;t<n.length;t+=1)if("test"!==n[t].type||this.checkIfTestAlreadyExistInArr(c,n[t].id))for(r=u[n[t].id]||[],s=0;s<r.length;s+=1)this.checkIfTestAlreadyExistInArr(c,n[t].id)||(r[s].pid=n[t].id,c.push(r[s]));else c.push(this.getProcessedTestObj(n[t],i,a,o));return c},this.checkIfTestAlreadyExistInArr=function(e,t){var s;for(s=0;s<e.length;s+=1)if(e&&e[s]&&e[s].id===t)return!0;return!1},this.getComboPackDetailsObj=function(e){var t={},s=this.getCompleteSortedCategorizedItemsArr(e,"test",!1,"asc");return t.alreadyPurchasedTestsCount=this.getAlreadyPurchasedTestsCount(e),t.remainingTestsCount=e.length-t.alreadyPurchasedTestsCount,t.testsArr=s,t.total=e.length,t},this.getAlreadyPurchasedTestsCount=function(e){var t,s=0;for(t=0;t<e.length;t+=1)e[t].isAlreadyPurchased&&(s+=1);return s},this.getAllTestsAssignedToStudent=function(t,s,i){var a=-1e7,o=t.data.products||[],n=t.data.tests||[],c=[],d=T[r]&&r&&e.getValidDays(T[r].expiry);if(n&&n.length&&s&&s.length)for(var u=0;u<s.length;u++){var l=s[u];n&&n.length&&n.indexOf(l.id)!==-1&&!this.checkIfTestAlreadyExistInArr(c,l.id)&&(l.subsExpiryInDays=-1e7,l.subsExpiryInDaysString="",c.push(l),P[l.id]={isPartOfCombo:!1,comboId:""})}if(o||o.length)for(var u=0;u<o.length;u++)if("test pack"==o[u].type.toLowerCase())for(var l=o[u],h=this.getTestsOfProduct(l,s),m=0;m<h.length;m++){var l=h[m];P[l.id]={isPartOfCombo:!1,comboId:""},l.myCardClass=this.getClassForMyTests(l),l.source=o[u].source,l.sourceId=o[u].sourceId||"",l.subsExpiryInDays=v&&v[l.sourceId]&&v[l.sourceId].expiryInDays||a,l.subsExpiryInDaysString=d>0?d>1?d+" days To dxpire subscription":d+" day To expire subscription":-d>1?"Subscription expired "+-d+" days ago":"Subscription expired "+-d+" day ago",this.checkIfTestAlreadyExistInArr(c,l.sourceId)||c.push(l)}for(var f=[],g=[],p=[],u=0;u<o.length;u++)if("combo pack"==o[u].type.toLowerCase()){if(p=[],P[o[u].pid]={isPartOfCombo:!1,comboId:""},o[u].products&&o[u].products.length)for(var m=0;m<o[u].products.length;m++)p.push(o[u].products[m].pid),P[o[u].products[m].pid]={isPartOfCombo:!0,comboId:o[u].pid};f=o[u].pid,g=g.concat(this.getTestsOfComboPacksForMyTests(f,o[u].source,o[u].sourceId,p))}for(var u=0;u<g.length;u++){var l=g[u];l.myCardClass=this.getClassForMyTests(l),this.checkIfTestAlreadyExistInArr(c,l.id)||i.indexOf(l.id)==-1||c.push(l)}for(var u=0;u<o.length;u++)o[u].tests&&n.push(o[u].pid);for(var u=0;u<o.length;u++){if(o[u].products&&o[u].products.length)for(var m=0;m<o[u].products.length;m++)n=n.concat(o[u].products[m].tests);o[u].tests&&o[u].tests.length&&(n=n.concat(o[u].tests))}for(var u=0;u<C.length;u++)if(n.indexOf(C[u].id)!=-1&&!this.checkIfTestAlreadyExistInArr(c,C[u].id)){var l=this.getProcessedTestObj(C[u]);l.myCardClass=this.getClassForMyTests(l),l.subsExpiryInDays=v&&v[l.sourceId]&&v[l.sourceId].expiryInDays||a,l.subsExpiryInDaysString=d>0?d>1?d+" days To dxpire subscription":d+" day To expire subscription":-d>1?"Subscription expired "+-d+" days ago":"Subscription expired "+-d+" day ago",c.push(l)}return c},this.getTestsOfProduct=function(e,t){var s=[];y[e.pid]&&(s=y[e.pid].items||[]);for(var i=t.length-1;i>=0;i--)for(var i=t.length-1;i>=0;i--)t[i].id==e.pid&&(t[i].id=t[i].items[0].id,s.push(t[i])||[]);return s},this.getTestsOfComboPacksForMyTests=function(t,s,i,a){for(var o=[],n=0;n<b.comboPacks.length;n++)for(var c=b.comboPacks[n].value,d=0;d<c.length;d++){var u=t.indexOf(c[d].id);u!=-1&&(o=o.concat(c[d].comboPackTests))}for(var l=e.getValidDays(T[r]&&T[r].expiry),n=0;n<o.length;n++){var h=a.indexOf(o[n].pid)!==-1;h&&(o[n].source=s||"",o[n].sourceId=i||"",o[n].subsExpiryInDays=v&&v[i]&&v[i].expiryInDays||-1e7,o[n].subsExpiryInDaysString=l>0?l>1?l+" days To expire subscription":l+" day to expire subscription":-l>1?"Subscription expired "+-l+" days ago":"Subscription expired "+-l+" day ago")}return o},this.getTotalTestCount=function(e,t,s){e=validateArr(e);var i=0;for(var r in s){var a=s[r];(!a.isPartOfHiddenProduct||a.isPartOfHiddenProduct&&e.indexOf(a.id)!=-1||a.isPartOfHiddenProduct&&t.indexOf(a.pid)==-1)&&(i+=1)}return i},this.getTotalQuestionsCount=function(e,t,s){e=validateArr(e);var i=0;for(var r in s){var a=s[r];a&&a.testDetails&&(!a.isPartOfHiddenProduct||a.isPartOfHiddenProduct&&e.indexOf(a.id)!==-1||a.isPartOfHiddenProduct&&t.indexOf(a.id)==-1)&&(i+=a.testDetails.questionsCount)}return i},this.resetNonProducts=function(e,t){for(var s=e.length-1;s>=0;s--){var i=e[s];P[i.id]&&!P[i.id].isPartOfCombo&&t?(i.isPartOfMyTests=!0,i.cardClass?i.cardClass=i.cardClass+" part-of-my-tests":i.cardClass="part-of-my-tests"):!P[i.id]||P[i.id].isPartOfCombo||t?P[i.id]&&P[i.id].isPartOfCombo&&e.splice(s,1):e.splice(s,1)}return e},this.resetPacks=function(e,t){for(var s=e.length-1;s>=0;s--){for(var i=e[s].value,r=i.length-1;r>=0;r--){var a=i[r];P[a.id]&&!P[a.id].isPartOfCombo&&t?(i[r].isPartOfMyTests=!0,i[r].cardClass?i[r].cardClass=i[r].cardClass+" part-of-my-tests":i[r].cardClass="part-of-my-tests"):!P[a.id]||P[a.id].isPartOfCombo||t?P[a.id]&&P[a.id].isPartOfCombo&&i.splice(r,1):i.splice(r,1)}i.length<1&&e.splice(s,1)}return e},this.resetComboPacks=function(e,t){for(var s=e.length-1;s>=0;s--){for(var i=e[s].value,r=i.length-1;r>=0;r--){var a=i[r];if(P[a.id]&&t)i[r].isPartOfMyTests=!0,i[r].isAlreadyPurchased=!0,i[r].cardClass?i[r].cardClass=i[r].cardClass+" part-of-my-tests":i[r].cardClass="part-of-my-tests",i[r]=this.processObjForComboUpgrade(i[r],P);else if(P[a.id]&&!t)i.splice(r,1);else for(var o=i[r].items,n=0;n<o.length;n++)if(P[o[n].id]&&P[o[n].id].comboId!=i[r].id||this.checkIfHasCommonTestsWithMyTests(a.comboPackTests)){i[r].isPartialPurchasedProduct=!0,i[r]=this.processObjForComboUpgrade(i[r],P),(i[r].cost<=0||i[r].comboPackDetails.remainingTestsCount<=0)&&i.splice(r,1);break}}i.length<1&&e.splice(s,1)}return e},this.processObjForComboUpgrade=function(e,t){for(var s=e.items||[],i=e.comboPackTests||[],r={},a=0;a<i.length;a++){var o=i[a].id;r[o]=i[a]}for(var n=(e.cost,0),c=0,a=0;a<s.length;a++){var d=s[a].id;l&&l[d]&&(n+=l[d].cost),t&&t[d]&&l[d]&&(c+=l[d].cost)}for(var a=0;a<i.length;a++){var o=i[a].id;m[o]&&(i[a].isAlreadyPurchased=!0)}for(var u=0,h=0,a=0;a<i.length;a++)i[a].isAlreadyPurchased?u+=1:h+=1;u>0&&0==h&&(e.cardClass?e.cardClass=e.cardClass+" part-of-my-tests":e.cardClass="part-of-my-tests"),e.isPartialPurchasedProduct=!0;var f=1-c/n;return e.cost=f*e.cost,e.cost=e.cost+9,e.cost=10*Math.floor(e.cost/10),e.oldCost=f*e.oldCost,e.oldCost=e.oldCost+9,e.oldCost=10*Math.floor(e.oldCost/10),e.oldCost%10>=5&&(e.oldCost=e.oldCost+10),e.oldCost=10*Math.floor(e.oldCost/10),e.offerText="SAVE RS. "+getRoundedFloat(e.oldCost-e.cost,0),e.comboPackDetails=this.getComboPackDetailsObj(i),e.categorizedSortedPackTests=this.getCompleteSortedCategorizedItemsArr(i,"test",!1,"asc"),e},this.checkIfHasCommonTestsWithMyTests=function(e){for(var t=validateArr(e),s=0;s<t.length;s+=1){var i=t[s].id;if(m[i])return!0}return!1}}]);
!function(){function t(t){var e=$("#cur-course-id")&&$("#cur-course-id").val()||"",r=function(t){for(var e=0;e<t.length;e+=1)t[e].chapterName=t[e].chapterName.replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"-"),t[e].section=t[e].section.replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"-");return t},a=function(t,e,r){return t?t.split(e).join(r):""},o=function(t,e,r){var o=a(r," ","-").toLowerCase(),c=a(e.chapterName," ","-").toLowerCase();return t=t?t:{chapterIdsArr:[],totalQues:0},t.chapterIdsArr.push({id:e.chapterId,name:e.chapterName,practiceUrl:"/"+u+"-practice/"+o+"/"+c+"-"+e.chapterId+"?page=current"}),t.totalQues+=e.qcount||0,t},c=function(t,e){for(var r={},a=0;a<t.length;a++){var c=t[a][e];r[c]=o(r[c],t[a],c)}return r},n=function(t){var e=[],r=c(t,"section"),a=[];t=validateArr(t);for(var o in r)r.hasOwnProperty(o)&&(a=r[o].chapterIdsArr.splice(7,r[o].chapterIdsArr.length),e.push({extraTopicsCount:a.length,section:o,chapters:r[o].chapterIdsArr,totalQues:r[o].totalQues,practiceUrl:"/"+u+"-practice/",isShow:!0}),p.totalQueCount+=e[e.length-1].totalQues);return e},s=function(){p.isLoadingTags=!0;var a=function(t){t.data&&(t.data=r(t.data),p.tagsArr=n(t&&t.data),p.extraChaptersCount=p.tagsArr.splice(4,p.tagsArr.length).length,p.isLoadingTags=!1)},o=function(t){t?showAlert(t.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3),hideLoader()};t.getPracticeTags(e,a,o)},i=function(){p.practiceUrl="/"+u+"-practice/",s()},u=document.getElementById("curCourseURL")&&document.getElementById("curCourseURL").value||"";this.tagsArr={},this.extraChaptersCount=0,this.totalQueCount=0,this.isLoadingTags=!0,this.practiceUrl="";var p=this;i()}angular.module("practiceChapterWidgetApp",["Testbook"]).controller("practiceChapterWidgetController",["TB",t])}();
angular.module("renderFinishModule",[]).directive("onFinishRender",["$timeout",function(n){return{restrict:"A",link:function(i,e,t){i.$last===!0&&n(function(){i.$emit(t.onFinishRender)})}}}]);
var app=app||{};app.controller("releasePlanCtrl",["$scope","$rootScope","TB","subscriptionService",function(t,e,a,s){t.statusClass="",t.notificationTextArr=s.notificationArr,t.featuresArr=[],e.$on("TOGGLE_RELEASE_PLAN_MODAL",function(e,a){o(a.toOpen,a.toMature),t.extraFeatures=a.data||[]}),e.$on("TOGGLE_RELEASE_PLAN_MATURITY",function(t,e){i(e.toMature)});var i=function(e){t.statusClass=e?"in mature":"in"},o=function(e){t.statusClass=e?"in":"",e||s.handleMaturityOfModal(!0),s.handleBodyScroll()};t.hideReleasePlan=function(){o(!1)},t.testPackBtnClicked=function(t,e){t=validateArr(t);for(var a=[],i=0;i<t.length;i++)a.push(t[i].pid||"");s.testPackBtnClicked(a.join(","),e)};var r=function(t){return parseInt(t)!=t&&!isNaN(new Date(t).getTime())};t.isValidDate=function(t){return r(t)},t.getDateObj=function(t){return new Date(t)},t.sortFunction=function(t,e){for(var a=0;a<t.length;a++)for(var s=t[a].children||[],i=0;i<s.length;i++)"datetime"==s[i].type.toLowerCase()&&(t[a].sortValue=new Date(s[i].title).getTime()||(new Date).getTime());return sortFunction(t,"sortValue","number","asc")}}]),app.controller("calculateSavingsCtrl",["$scope","$rootScope","TB","subscriptionService",function(t,e,a,s){t.statusClass=!1,t.isShowCalc=!1,t.subsObj={},e.$on("TOGGLE_CALCULATE_SAVINGS_MODAL",function(e,a){t.subsObj=a.subsObj,t.subscriptionTotal={cost:0,baseCost:0,testCount:0,baseTestCount:0,eachTestCost:0,tidsObj:{},commonTids:{}},t.calcTotal={cost:0,baseCost:0,testCount:0,baseTestCount:0,eachTestCost:0,tidsObj:{},commonTids:{}},t.isCalcBtnDisabled=!0,t.toggleModal(a.toOpen),t.calcData=o(a.data[0]||[]),t.chooseCourseUIDS=i(a.data[1]||[])}),t.toggleModal=function(e){t.statusClass=e?t.statusClass?"in mature":"in":"",e||s.handleMaturityOfModal(!0),s.handleBodyScroll()},t.subscribeNowBtnClicked=function(){s.purchaseSubscriptionEventFire(t.subsObj)};var i=function(t){for(var e=[],a={},s=0,i=0,o=0;o<t.length;o++){i=0,s=Math.ceil(t[o].exams.length/3),a={},a.course=t[o].course,a.isChecked=!1,a.examsUI=[];for(var r=0;r<s;r++)a.examsUI.push([t[o].exams[i]&&{title:t[o].exams[i].title,isChecked:!1}||{},t[o].exams[i+1]&&{title:t[o].exams[i+1].title,isChecked:!1}||{},t[o].exams[i+2]&&{title:t[o].exams[i+2].title,isChecked:!1}||{}]),i+=3;e.push(a)}return e};t.isPreferred=!0;var o=function(e){for(var a=[],s={},i=0;i<e.length;i++)s={},s.title=e[i].title,s.cost=e[i].cost,s.testCount=e[i].testCount,s.isChecked=e[i].isChecked||!1,s.testArrObj=e[i].testArrObj||[],a.push(s),c(t.subscriptionTotal,s.testArrObj,!0),t.subscriptionTotal.testCount=Object.keys(t.subscriptionTotal.tidsObj).length;return t.subscriptionTotal.cost=t.subsObj.hasOwnProperty("newCost")?t.subsObj.newCost:t.subsObj.cost,t.subscriptionTotal.testCount=t.subscriptionTotal.baseTestCount-n(t.subscriptionTotal.commonTids||{}),t.subscriptionTotal.eachTestCost=Math.round(t.subscriptionTotal.cost/t.subscriptionTotal.testCount)||0,a},r=function(t){var e=0;for(var a in t)e+=t[a].cost*t[a].count;return e},n=function(t){var e=0;for(var a in t)e+=t[a].count;return e},c=function(t,e,a){for(var s=0;s<e.length;s++)a?(t.tidsObj.hasOwnProperty(e[s].tid)?t.commonTids[e[s].tid]?t.commonTids[e[s].tid].count+=1:(t.commonTids[e[s].tid]={},t.commonTids[e[s].tid].cost=e[s].cost,t.commonTids[e[s].tid].count=1):t.tidsObj[e[s].tid]=e[s].cost,t.baseCost+=e[s].cost,t.baseTestCount+=1):t.tidsObj.hasOwnProperty(e[s].tid)&&(t.commonTids[e[s].tid]?t.commonTids[e[s].tid].count>1?t.commonTids[e[s].tid].count-=1:delete t.commonTids[e[s].tid]:delete t.tidsObj[e[s].tid],t.baseCost-=e[s].cost,t.baseTestCount-=1)};t.calculateTotal=function(e){t.isCalcBtnDisabled=!u(),e.isChecked?(c(t.calcTotal,e.testArrObj,e.isChecked),t.calcTotal.cost=t.calcTotal.baseCost-r(t.calcTotal.commonTids||{}),t.calcTotal.testCount=t.calcTotal.baseTestCount-n(t.calcTotal.commonTids||{})):(c(t.calcTotal,e.testArrObj,e.isChecked),t.calcTotal.cost=t.calcTotal.baseCost-r(t.calcTotal.commonTids||{}),t.calcTotal.testCount=t.calcTotal.baseTestCount-n(t.calcTotal.commonTids||{})),t.calcTotal.eachTestCost=Math.round(t.calcTotal.cost/t.calcTotal.testCount)||0,t.isPreferred=!t.calcTotal.cost||!(t.calcTotal.cost<t.subscriptionTotal.cost)};var l=function(t,e){for(var a=0;a<t.length;a++)t[a][0].isChecked=e,t[a][1].isChecked=e,t[a][2].isChecked=e};t.isCalcBtnDisabled=!0;var u=function(){for(var e=0;e<t.calcData.length;e++)if(t.calcData[e].isChecked)return!0;return!1},d=function(){for(var e=0;e<t.chooseCourseUIDS.length;e++)for(var a=0;a<t.chooseCourseUIDS[e].examsUI.length;a++)for(var s=0;s<t.chooseCourseUIDS[e].examsUI[a].length;s++)if(t.chooseCourseUIDS[e].examsUI[a][s].hasOwnProperty("isChecked")&&t.chooseCourseUIDS[e].examsUI[a][s].isChecked)return!1;return!0};t.checkSelectedExam=function(e){t.isCalcBtnDisabled=d();for(var a=0;a<e.examsUI.length;a++)for(var s=0;s<e.examsUI[a].length;s++)if(e.examsUI[a][s].hasOwnProperty("isChecked")&&!e.examsUI[a][s].isChecked)return void(e.isChecked=!1);e.isChecked=!0},t.checkSelectedCourse=function(e){e.isChecked?l(e.examsUI,!0):l(e.examsUI,!1),t.isCalcBtnDisabled=d()},t.hideCalcSavings=function(){t.toggleModal(!1),s.handleMaturityOfModal(),t.isShowCalc=!1},t.calculateSavingBtnClicked=function(){for(var e=0;e<t.calcData.length;e++){for(var a=0;a<t.chooseCourseUIDS.length;a++)for(var s=0;s<t.chooseCourseUIDS[a].examsUI.length;s++)t.chooseCourseUIDS[a].examsUI[s][0].title==t.calcData[e].title&&(t.calcData[e].isChecked=t.chooseCourseUIDS[a].examsUI[s][0].isChecked),t.chooseCourseUIDS[a].examsUI[s][1].title==t.calcData[e].title&&(t.calcData[e].isChecked=t.chooseCourseUIDS[a].examsUI[s][1].isChecked),t.chooseCourseUIDS[a].examsUI[s][2].title==t.calcData[e].title&&(t.calcData[e].isChecked=t.chooseCourseUIDS[a].examsUI[s][2].isChecked);t.calcData[e].isChecked&&t.calculateTotal(t.calcData[e])}t.isShowCalc=!0,scrollToTop(".modal-hero-content",400)}}]),app.controller("testPackCtrl",["$scope","$rootScope","TB","subscriptionService",function(t,e,a,s){t.notificationTextArr=s.notificationArr,t.statusClass="",t.ReleasePackDetails=[],e.$on("TOGGLE_TEST_PACK_MODAL",function(e,a){o(a.toOpen,a.toMature),t.getReleasePackDetails(a.productIds,a.status||"released")}),e.$on("TOGGLE_TEST_PACK_MATURITY",function(t,e){i(e.toMature)}),t.getReleasePackDetails=function(e,s){var i=function(t){t=validateArr(t);for(var e=0,a=0;a<t.length;a++)e+=t[a].qCount||0;return e||0},o=function(t){return{title:t.title||"",questionsCount:i(t.pattern&&t.pattern.sections)||[],releaseDate:new Date(t.availFrom),availTillDate:new Date(t.availTill)}},r=function(t){for(var e={},a=t.items||[],s={packName:t.title,productMap:{}},i=0;i<a.length;i++){var r=a[i].pattern||{};e[r.title]||(e[r.title]={value:[],patternName:r.title}),e[r.title].value.push(o(a[i]))}return s.productMap=e,s},n=function(t){for(var e={},a=0;a<t.length;a++){t[a].items||[];e[t[a]._id]=r(t[a])}return e},c=function(e){t.testDetailsLoading=!1,t.releasePackDetails=n(e.data&&e.data.products)},l=function(e){t.testDetailsLoading=!1,t.releasePackDetails={},showAlert(e.message||"Something went wrong, Please try again.","error","sm",5e3)};t.testDetailsLoading=!0,a.getReleasePackProductDetails({pids:e,status:s},c,l)};var i=function(e){t.statusClass=e?"in mature":"in"},o=function(e){t.statusClass=e?"in":"",e||s.handleMaturityOfModal(!0),s.handleBodyScroll()};t.hideTestPack=function(){o(!1)}}]),app.controller("renewPlanCtrl",["$scope","$rootScope","TB","subscriptionService",function(t,e,a,s){t.statusClass="",t.notificationTextArr=s.notificationArr,e.$on("TOGGLE_RENEW_SUBSCRIPTION_PLAN_MODAL",function(t,e){o(e.toOpen)}),e.$on("TOGGLE_RENEW_SUBSCRIPTION_PLAN_MATURITY",function(t,e){i(e.toMature)});var i=function(e){t.statusClass=e?"in mature":"in"},o=function(e){t.statusClass=e?"in":"",e||s.handleMaturityOfModal(!0),s.handleBodyScroll()};t.showCalculationPlan=function(t){s.calcSavingsBtnClicked(t,t.calcData,t.courseSelectionDS)},t.hideRenewPlanModal=function(){o(!1)}}]),app.controller("SubscriptionHIW",["$scope",function(t){t.$on("$includeContentLoaded",function(){function t(){n=new YT.Player("subscriptionVideoPlayer",{height:"505",width:"900",videoId:"DyOMTC8g3lg",enablejsapi:1,events:{onReady:e,onStateChange:a},origin:window.location.origin,playerVars:{color:"white",loop:1,rel:0,showinfo:0}})}function e(t){t.target.playVideo()}function a(t){}function s(){n.pauseVideo()}function i(){n.playVideo()}var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(o,r);var n,c="#subscriptionVideoPlayer",l="#subscription-helper";$(l).on("shown.bs.modal",function(){void 0===$(c).attr("src")?(t(),makeVideosResponsive()):i()}),$(l).on("hide.bs.modal",function(){s()})})}]),app.service("subscriptionService",["$rootScope","$timeout",function(t,e){this.callDataLayerFunction=function(){e(function(){"undefined"!=typeof dataLayer?(dataLayer.push({event:"api.cb"}),console.log("data-layer called with argument {'event': 'api.cb'}")):console.log("data-layer does not exist")},2e3)},this.notificationArr=["Check the test release and expiry date by clicking on the Test Release Plan link for all exams."],this.modalHeroPathStack=[],this.calcSavingsBtnClicked=function(e,a,s){this.modalHeroPathStack.push("calculator"),t.$broadcast("TOGGLE_CALCULATE_SAVINGS_MODAL",{toOpen:!0,data:[a,s],subsObj:e}),this.handleMaturityOfModal(!1)},this.releasePlanBtnClicked=function(e){this.modalHeroPathStack.push("release-plan"),t.$broadcast("TOGGLE_RELEASE_PLAN_MODAL",{toOpen:!0,data:e}),this.handleMaturityOfModal(!1)},this.testPackBtnClicked=function(e,a){this.modalHeroPathStack.push("test-pack"),t.$broadcast("TOGGLE_TEST_PACK_MODAL",{toOpen:!0,productIds:e,status:0==a?"released":"upcoming"}),this.handleMaturityOfModal(!1)},this.renewSubscriptionBtnClicked=function(){this.modalHeroPathStack.push("renew-subscription"),t.$broadcast("TOGGLE_RENEW_SUBSCRIPTION_PLAN_MODAL",{toOpen:!0}),this.handleMaturityOfModal(!1)},this.toggleCalcMaturity=function(e){t.$broadcast("",{toOpen:!0,toMature:e})},this.toggleReleaseMaturity=function(e){t.$broadcast("TOGGLE_RELEASE_PLAN_MATURITY",{toMature:e})},this.toggleTestPackMaturity=function(e){t.$broadcast("TOGGLE_TEST_PACK_MATURITY",{toMature:e})},this.toggleRenewSubMaturity=function(e){t.$broadcast("TOGGLE_RENEW_SUBSCRIPTION_PLAN_MATURITY",{toMature:e})},this.purchaseSubscriptionEventFire=function(e){t.$broadcast("PURCHASE_SUBSCRIPTION_FROM_CALCULATOR",{data:e})},this.handleMaturityOfModal=function(t){var e="";if(t)this.modalHeroPathStack.pop(),e=this.modalHeroPathStack[this.modalHeroPathStack.length-1];else{if(!(this.modalHeroPathStack.length>1))return;e=this.modalHeroPathStack[this.modalHeroPathStack.length-2]}switch(e){case"calculator":this.toggleCalcMaturity(!t);break;case"release-plan":this.toggleReleaseMaturity(!t);break;case"test-pack":this.toggleTestPackMaturity(!t);break;case"renew-subscription":this.toggleRenewSubMaturity(!t);break;case"subscription":this.toggleRenewSubMaturity(!t)}},this.getCoursesString=function(t){for(var e="",a=0;a<t.length;a++)e+=t[a].name+" . ";return e},this.isShowFromTbLogic=function(t,e,a){for(var s=!1,i=0;i<t.courses.length;i++)if(a[t.courses[i].id]&&(this.getValidDays(a[t.courses[i].id].expiry)<0||a[t.courses[i].id].validity<t.validity)){s=!0;break}return(t.courses.length>1&&s||e.isActive)&&e.cost>0},this.getDiscount=function(t,e){return t>=e?t-e:0},this.getPurchasedSubsMap=function(t){var e={};t=validateArr(t);for(var a=0;a<t.length;a++)this.subsBundleIdToObjMap[t[a]._id]&&(e[t[a]._id]={expiryInDays:this.getValidDays(t[a].expiry),expiryInDaysString:"",expiryDate:new Date(t[a].expiry),purchaseDate:new Date(new Date(t[a].expiry)-this.convertNanosecToMillisec(this.subsBundleIdToObjMap[t[a]._id].validity)),courses:t[a].courses,isExpired:!((new Date).getTime()<=new Date(t[a].expiry).getTime())},e[t[a]._id].expiryInDaysString=e[t[a]._id].expiryInDays>1?e[t[a]._id].expiryInDays+" Days":e[t[a]._id].expiryInDays+"Day");return e};var a=function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a].cost;return e},s={released:"released test packs",upcoming:"upcoming test packs",expected:"expected test packs"},i=function(t){for(var e=[],i={},o={},r=0;r<t.length;r++)if((t[r].title.toLowerCase()==s.released||t[r].title.toLowerCase()==s.upcoming)&&t[r].children)for(var n=0;n<t[r].children.length;n++)for(var c=1;c<t[r].children[n].children.length;c++)i={},i.title=t[r].children[n].children[c].children[0].title,o.hasOwnProperty(i.title)?(i.testCount=parseInt(t[r].children[n].children[c].children[1].title)+e[o[i.title]].testCount,i.testArrObj=t[r].children[n].children[c].children[4].meta,i.cost=a(i.testArrObj)+e[o[i.title]].cost,i.testArrObj=i.testArrObj.concat(e[o[i.title]].testArrObj)):(i.testCount=parseInt(t[r].children[n].children[c].children[1].title),i.testArrObj=t[r].children[n].children[c].children[4].meta,i.cost=a(i.testArrObj),o[i.title]=e.length),e[o[i.title]]=i;return e},o=function(t){for(var e=[],a={},i={},o={},r=0;r<t.length;r++)if((t[r].title.toLowerCase()==s.released||t[r].title.toLowerCase()==s.upcoming)&&t[r].children)for(var n=0;n<t[r].children.length;n++)if(a={},a.course=t[r].children[n].meta.course,o.hasOwnProperty(a.course)){a.exams=e[o[a.course].pos].exams;for(var c=1;c<t[r].children[n].children.length;c++)i={},i.title=t[r].children[n].children[c].children[0].title,o[a.course].hasOwnProperty(i.title)||(o[a.course][i.title]=a.exams.length,a.exams[o[a.course][i.title]]=i);e[o[a.course].pos]=a}else{o[a.course]={pos:e.length},a.exams=[];for(var c=1;c<t[r].children[n].children.length;c++)i={},i.title=t[r].children[n].children[c].children[0].title,o[a.course].hasOwnProperty(i.title)||(o[a.course][i.title]=a.exams.length,a.exams[o[a.course][i.title]]=i);e.push(a)}return e},r=function(t,e){for(var a=0,s=0;s<e.length;s++)t.hasOwnProperty(e[s])&&a++;return a},n=function(t){for(var e=[],a={},i=0;i<t.length;i++)if((t[i].title.toLowerCase()==s.released||t[i].title.toLowerCase()==s.upcoming)&&t[i].children)for(var o=0;o<t[i].children.length;o++)for(var r=1;r<t[i].children[o].children.length;r++){e=t[i].children[o].children[r].children[4].meta;for(var n=0;n<e.length;n++)a[e[n].tid]=1}return a},c=function(t,e){for(var a=0,s=0;s<t.courses.length;s++)if(e.hasOwnProperty(t.courses[s].id)&&(a=new Date(e[t.courses[s].id].expiry).getTime(),a-(new Date).getTime()>0))return!0;return!1};this.processSubscriptionObject=function(t,e,a,s){s=s?s:[];var u={},d=function(t){var e=864e11;return Math.round(t/e)},h=function(e,a){if(t.isHidden)return e.isActive&&!!a&&!a.isExpired;if(0===e.cost){if(a&&a.purchaseDate){var s=new Date(a.purchaseDate).setHours(0,0,0,0),i=s+864e5;return(new Date).getTime()>=s&&(new Date).getTime()<=i}return!1}return e.cost>0};u.id=t._id||"-1",u.availTill=new Date(t.availTill)||new Date,u.category=t.category||"",u.cost=Math.round(this.calculateSubsBundleCost(t,e))||0,u.oldCost=t.oldCost||t.cost||0,u.completePackCost=t.cost||0,u.couponGoldenRatio=getRoundedFloat(u.cost/u.completePackCost,2)||1,u.coursesObjArr=t.courses||[],u.courseNamesArr=getSpecificKeyArrFromArrayOfObjects(t.courses,"name"),u.coupon=t.offerCoupon||{},u.description=t.description||"",u.pattern=u.pattern||{},u.title=t.title||"",u.recommendedFor=t.recommendedFor||"",u.offerText=0==t.cost?"FREE":u.discountText,u.type=t.type||"others",u.isActive=!!a[t._id],u.isShow=h(u,a[t._id]),u.specificExamObjArr=t.specificExams,u.cardClass=this.getSubscriptionCardClass(t),u.subTitle="",u.coursesStr=this.getCoursesString(t.courses),u.featureArr=t.features||[],u.items=t.items||[],u.discount=this.getDiscount(u.oldCost,u.cost),u.colorHex=l(t.colorHex),u.validity=this.getValidMonth(t.validity)||0,u.validityInDaysTemp=d(t.validity||0),u.validityInDaysTemp%30===0?u.validityStringTemp=u.validityInDaysTemp/30>1?u.validityInDaysTemp/30+" Months":u.validityInDaysTemp/30+" Month":u.validityStringTemp=u.validityInDaysTemp>1?u.validityInDaysTemp+" days":u.validityInDaysTemp+" day",u.validityInDays=30*u.validity||0,u.subStrInSubCard=12==u.validity?"For 1 Year":u.validity>1?"For "+u.validity+" Months":"For "+u.validity+" Month",u.validityString=u.validity>1?u.validity+" Months":u.validity+" Month",u.extraFeatures=t.extraFeatures||[],u.totalTest=this.getTotalTestInBundle(t.extraFeatures),u.calcData=i(t.extraFeatures||[]),u.courseSelectionDS=o(t.extraFeatures||[]),u.isActive&&t.hasOwnProperty("hasExtendedValidity")&&t.hasExtendedValidity&&(u.hasExtendedValidity=t.hasExtendedValidity);var p=n(t.extraFeatures||[]);return u.attemptedTest=r(p,s),u.isActive?(u.isExpired=!(new Date(a[u.id].expiryDate).getTime()-(new Date).getTime()>0),u.isExpired?u.statusClass="subs-expired":(u.attemptedPercent=Math.round(100*u.attemptedTest/u.totalTest).toString()+"%",u.statusClass="subs-active")):c(t,e)?u.statusClass="subs-inactive subs-upgrade":u.statusClass="subs-inactive",u};var l=function(t){return t=t?t:"ffffff",t.indexOf("#")!=-1?t:"#"+t};this.mockTestSubsFilter=function(t,e,a){var s=[],i="";for(var o in e)e[o].expiryInDays<=0&&(i+=this.getCoursesString(e[o].courses));for(var r=0;r<a.length;r++)e[a[r].id]&&e[a[r].id].expiryInDays>0||i.trim()&&a[r].coursesStr.toLowerCase().indexOf(t.toLowerCase())!=-1&&a[r].coursesStr.toLowerCase().indexOf(i.toLowerCase())!=-1&&s.push(a[r]);return s},this.getTotalTestInBundle=function(t){t=validateArr(t);for(var e=0,a=0;a<t.length;a++)if((t[a].title.toLowerCase()==s.released||t[a].title.toLowerCase()==s.upcoming)&&t[a].children)for(var i=0;i<t[a].children.length;i++)e+=parseInt(t[a].children[i].meta.testCount);return e},this.getValidMonth=function(t){var e=2592e12;return Math.round(t/e)},this.getValidDays=function(t){var e=new Date(t).getTime()-(new Date).getTime();return Math.round(e/864e5)},this.getSubscriptionCardClass=function(t){var e="subs-inactive";return e},this.getCoursesString=function(t){for(var e=[],a=0;a<t.length;a++)e.push(t[a].name);return e.join(" . ")},this.subsBundleIdToObjMap={},this.convertNanosecToMillisec=function(t){return t/1e6},this.calculateSubsBundleCost=function(t,e){var a={},s=0,i=1,o=t.validity,r=t.items||[],n=0;if(r.length)for(var c=0;c<r.length;c++)a=this.subsBundleIdToObjMap[r[c].id]||{},n+=a.cost,s+=this.calculateSubsCost(a,e,o);else n=t.cost,s=t.cost;return i=t.cost/n,s*i},this.calculateSubsCost=function(t,e,a){if(t.courses&&e.hasOwnProperty(t.courses[0].id)){var s=e[t.courses[0].id].expiry-(new Date).getTime(),i=this.convertNanosecToMillisec(a);if(s>i)return 0;s<0&&(s=0);var o=0;return i-s>0&&(o=(i-s)/i),t.cost*o}return t.cost||0},this.getCourseToExpiryMap=function(t){var e={};t=validateArr(t);for(var a=0;a<t.length;a++)for(var s=0;s<t[a].courses.length;s++)if(e.hasOwnProperty(t[a].courses[s].id)){var i=e[t[a].courses[s].id].expiry,o=new Date(t[a].expiry).getTime();o>i&&(e[t[a].courses[s].id].expiry=o,e[t[a].courses[s].id].subsId=t[a]._id)}else e[t[a].courses[s].id]={},e[t[a].courses[s].id].expiry=new Date(t[a].expiry).getTime(),e[t[a].courses[s].id].subsId=t[a]._id;return e},this.handleBodyScroll=function(){this.modalHeroPathStack&&this.modalHeroPathStack.length>=1?$("body").addClass("modal-open"):$("body").removeClass("modal-open")},this.getRoundedToTens=function(t){return t=Math.floor(t),t+=9,t=10*Math.floor(t/10),t=t%10>=5?t+10:t}}]);
!function(){function e(e,i,d,c,u,l){function p(){var e=".js-exam-nav";$(e).trigger("sticky_kit:detach");var t=getAnnBannerHeight();$(e).stick_in_parent({offset_top:t+52+16})}function m(){var e=getAnnBannerHeight();$("body").scrollspy({target:".js-exam-nav",offset:52+e+16})}function g(){var t,s,r,a=!1;for(t=0;t<e.myTestsArr.length;t+=1)for(r=e.myTestsArr[t].value,s=0;s<r.length;s+=1)r[s].isLiveTest&&(a=!0);a&&f()}function f(){var t,s,r,a=!1;for(t=0;t<e.myTestsArr.length;t+=1)for(r=e.myTestsArr[t].value,s=0;s<r.length;s+=1)r[s].isLiveTest&&(r[s].liveTestTimer=T(r[s]),a=b());a&&c(function(){g()},1e3)}function b(){var t,s,r;for(t=0;t<e.myTestsArr.length;t+=1)for(r=e.myTestsArr[t].value,s=0;s<r.length;s+=1)if(r[s].isLiveTest===!0&&!r[s].isPreLaunch&&(r[s].myCardClass.search("lt-default-state")!==-1||r[s].myCardClass.search("lt-start-test")!==-1))return!0;return!1}function T(e){var t,s,r,a,o,n,i,c,u,l=e,p=d.currentTime,m=(new Date(l.startTimeLive).getTime()-p)/1e3,g=(new Date(l.endTimeLive).getTime()-p)/1e3,f=0,b="";return m>0?(f=m,b=" To Start"):m<0&&g>0&&(f=g,b="Ends in"),t=getDaysDiff(new Date(l.startTimeLive).getTime(),d.currentTime),s=Math.floor(f/3600),r=Math.ceil((f-3600*s)/60),a=Math.floor(f-3600*s-60*Math.floor((f-3600*s)/60)),l.myCardClass=d.getClassForMyTests(l),o=t>1?t+" days to go":t+" day to go",n=s>1?s+" hours to go":s+" hour to go",i=r>1?r+" minutes to go":r+" minute to go",c=a>1?a+" seconds to go":a+" second to go",u=b+" "+pad(s)+":"+pad(r)+":"+pad(a),t&&m>0?o:parseInt(s)&&m>0?n:parseInt(r)+1&&m>0?i:parseInt(a)&&m>0?c:u}function h(e){for(var t=0;t<e.length;t++)if(e[t].isShow&&!e[t].isActive)return!0;return!1}function A(t){var r,a,o=[],n=[],i=validateArr(t);for(r=0;r<i.length;r+=1)"subscription"===i[r].type.toLowerCase()||"subscription bundle"===i[r].type.toLowerCase()?o.push(i[r]):n.push(i[r]);if(parseInt(s)!==-1)V(o);else{for(u.subsBundleIdToObjMap=getCustomMap(o,"_id","",!0),r=0;r<o.length;r+=1)a=u.processSubscriptionObject(o[r],{},{},[]),e.subsArr.push(a),e.subsArrMap[a.id]=a||{};C(e.subsArr)}return n}function C(t){var s,r;for(s=0;s<t.length;s+=1)t[s].isActive&&!t[s].isExpired&&(e.isSubscriptionActive=!0,d.setSubscriptionStatus(e.isSubscriptionActive));var a=function(t){for(r in e.courseIdToExpiryMap)if(e.courseIdToExpiryMap.hasOwnProperty(r))for(s=0;s<t.length;s+=1)t[s].courses&&t[s].courses.length&&r===t[s].courses[0].id&&e.courseIdToExpiryMap[r].expiry-(new Date).getTime()>0&&(t[s].cardClass=d.getProductCardClass(t[s],[],!1))};a(e.packsArrForCourses),a(e.combosArrForCourses)}var v,y=0,I={},P=[],S=function(e){return"string"==typeof e&&(e=e.replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&#039;/g,"'").replace(/&quot;/gi,'"').replace(/&amp;/gi,"&")),e},k=function(t){e.$parent.$broadcast("COURSE_CHANGED",{courseId:t})},w=function(t){var s={courseId:t,isEnrolled:!0};e.$parent.$broadcast("COURSE_ENROLLED_DE_ENROLLED",s)},O=function(){e.$parent.$broadcast(o,{isShow:!1})},M=function(s){var r=function(r){k(s),forceSessionRefresh(!0);var a={id:s,name:e.currentCourseName};t.UpdateCurrentCourseInStorage(a)},a=function(e){e?showAlert(e.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)},o={course:s};i.setCurrentCourse(o,r,a)},E=function(t){for(var s=0;s<v.enrollments.length;s++)if(v.enrollments[s].course&&v.enrollments[s].course.id===t&&v.enrollments[s].course.hasOwnProperty("isInactive"))return void(v.enrollments[s].course.isInactive=!1);v.enrollments.push({course:{id:t,name:e.currentCourseName,url:e.currentCourseUrl}})},j=function(t){for(var s=0;s<t.length;s+=1)if(e.currentCourseId===t[s].course.id){if(!t[s].course.isInactive)return!0;e.isReEnroll=!0}return!1},x=function(){var r=function(t){t.hasOwnProperty("message")?showAlert(t.message||"Something went wrong please contact at support@testbook.com","error","small",5e3):(v=t.data||{},e.isEnrolledInCourse=j(v.enrollments||[]),e.isEnrolledInCourse&&v.currentCourse&&v.currentCourse.id!==e.currentCourseId&&M(e.currentCourseId))};parseInt(s)!==-1&&t.GetStudentFromStorage(r)},R=function(e){var t=function(e){var t=[],s={},r=[];e=validateArr(e);for(var a=0;a<e.length;a++){s.heading=e[a].heading;for(var o=0;o<e[a].description.length;o++)"html"===e[a].description[o].type&&r.push({type:"html",value:e[a].description[o].value});s.content=r,s.meta={name:e[a].subHeading,url:e[a].subHeading.replace(/\s/g,"-").replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"-").toLowerCase()},t.push(s),r=[],s={}}return t};return{logo:e.logo||"",heading:e.heading||"",meta:{description:e.meta&&e.meta.description||"",keywords:e.meta&&e.meta.keywords||"",pageTitle:e.meta&&e.meta.title||"",title:e.meta&&e.meta.title||"",og:{url:window.location.origin+window.location.pathname,title:e.og&&e.og.title||"",image:e.og&&e.og.logo||"/assets/img/other/tb-share-v1.png",description:e.og&&e.og.description||""}},subHeading:e.subHeading,sectionDataArr:t(e.sections)}},_=function(){e.isLoading.examInfo=!0;var t=function(t){t&&t.data&&(e.isLoading.examInfo=!1,"freeze"===t.data.stage?e.examData=R(t.data):window.location.href="/404")},s=function(t){e.isLoading.examInfo=!1,t?showAlert(t.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)};i.getExamPageInfo(e.currentCourseId,r,t,s)},D=function(t,s,r,a){t=validateArr(t),s=validateArr(s),r=validateArr(r),a=validateArr(a);for(var o=[],n=[],i=0;i<t.length;i++)t[i].isQuiz&&!I[t[i].id]?(t[i].isShow=!0,t[i].isUnattempted=!0,n.push(t[i])):I[t[i].id]||o.push(t[i]);for(var d=[],c=[],i=0;i<s.length;i++){d=[],c=[],d=s[i].value||[];for(var u=0;u<d.length;u++)d[u].isQuiz&&!I[t[i].id]?(d[u].isShow=!0,d[u].isUnattempted=!0,n.push(d[u])):c.push(d[u]);e.myTestsArr[i].value=c}return e.testsArrForCourses=o,e.allTestsObj.nonProducts=o,n=n.concat(r),n=n.concat(a),L(n,"id")},L=function(e,t){e=validateArr(e);var s,r={},a=[],o="";for(s=0;s<e.length;s+=1)o=e[s][t]||s,r[o]=e[s];for(o in r)r.hasOwnProperty(o)&&a.push(r[o]);return a},F=function(){for(var t=[],s=[],r=[],a=0;a<e.myTestsArr.length;a++){r=[],t=[],r=e.myTestsArr[a].value||[];var o=e.myTestsArr[a].categoryName||"";if("paused tests"===o.toLowerCase()){for(var n=0;n<r.length;n++)if(r[n].isQuiz){var i=r[n].category||"";r[n].categoryObj=e.allCategoryObjById[i],r[n].cardClass+=" resumable-quiz",r[n].isResumable=!0,s.push(r[n]),I[r[n].id]=!0}else t.push(r[n]);e.myTestsArr[a].value=t}}return s},z=function(){for(var t=[],s=[],r=[],a=[],o=0;o<e.attemptedCategorizedArr.length;o++){r=[],a=[],r=e.attemptedCategorizedArr[o].value||[];for(var n=0;n<r.length;n++)r[n].isQuiz?(r[n].cardClass+=" attempted-quiz",r[n].isAttempted=!0,t.push(r[n]),I[r[n].id]=!0):(a.push(r[n]),s.push(r[n]));e.attemptedCategorizedArr[o].value=a}return e.attemptedTestsArr=s&&s.length?s:[],t};e.allQuizesArr=[],e.todaysQuizArr=[],e.previousQuizArr=[],e.pausedQuizArr=[],e.attemptedQuizArr=[],e.quizFilter={exams:[],types:[]};var U=function(e){var t=LS.currentQuizInfo;t.value.servesOn=e.servesOn,t.value.exam=e.specificExamsDL||[],t.value.course=t.value.exam.length&&TB.mapExamIDToInfo[t.value.exam[0].id]?TB.mapExamIDToInfo[t.value.exam[0].id].parent.name:"",t.value.page=window.location.href,t.value.category=e.categoryObj.name,setLocalStorage(t.key,JSON.stringify(t.value))},B=function(){e.attemptedQuizArr=z(),e.pausedQuizArr=F(),e.allQuizesArr=D(e.allTestsObj.nonProducts,e.myTestsArr,e.pausedQuizArr,e.attemptedQuizArr),e.allQuizesArr=sortFunction(e.allQuizesArr,"servesOn","number","desc"),e.initializeCoursePage()},H=function(e,t){for(var s=[],a=0;a<e.length;a++)if(e[a].specificExams){for(var o=0;o<e[a].specificExams.length;o++)if(e[a].specificExams[o].id===r){s.push(e[a]);break}}else t&&s.push(e[a]);return s},N=function(t){e.setResumableTests(t),e.myTestsIds=e.getAllTestIdsAssignedToStudent(t)||[],e.mycoins=t.data.coins;var s=t&&t.data&&t.data.attemptedTestsDetails||[],r=t.data.attemptedTests||[],a=d.getAllTestsAssignedToStudent(t,e.allTestsObj.nonProducts,e.myTestsIds);e.myTestsIdObjMAP=getCustomMap(a,"id","",!0),d.setMyTestsIdObjMAP(e.myTestsIdObjMAP),e.processAllTests(),e.makeTestIdToTestMap(a),e.setMyTests(a,r,t.data.attemptedTestsDetails),e.initializeCoursePage();var o=function(t){var r=function(r){if(r&&r.data&&r.data.length){r.data=H(r.data);for(var a=[],o=0;o<r.data.length;o++)a.push(d.getProcessedTestObj(r.data[o]));var n=e.processAttemptedTests(a,s||[]);e.attemptedTestsArr=e.getSortedAttemptedTestsArr(n,t)}B()},a=function(e){e?showAlert(e.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)},o={courseId:e.currentCourseId,tests:t.join(","),isAttemptedCase:!0};i.getExpiredAttemptedTests(o,r,a)};r&&r.length?o(r):B(),C(e.subsArr)},Q=function(){var t=function(t){hideLoader(),y+=1,e.studentApiData=t,2===y&&N(e.studentApiData)},r={medium:"web"};e.studentApiData={},i.getStudentDetails(s,e.currentCourseId,r,t)},q=function(){var t=function(t){var r=[];if(t&&t.data){t.data.paid_tests&&(t.data.paid_tests=H(t.data.paid_tests)),t.data.products&&(t.data.products=H(t.data.products,!0)),t.data.quizzes&&(t.data.quizzes=H(t.data.quizzes)),t.data.tests&&(t.data.tests=H(t.data.tests)),r=validateArr(t.data.categories),e.allCategoryObjByName=getCustomMap(r,"name","",!0),e.allCategoryObjById=getCustomMap(r,"_id","",!0),d.setAllCategoryMap(e.allCategoryObjById),t.data.quizzes&&t.data.quizzes.length&&(e.totalQuizes=t.data.quizzes.length||0,t.data.tests&&t.data.tests.length?t.data.tests=t.data.tests.concat(t.data.quizzes):t.data.tests=t.data.quizzes),e.mapPidToItems=getCustomMap(t.data.products,"_id","items",!1),e.mapPidToProduct=getCustomMap(t.data.products,"_id","",!0),d.setPidToItemsMap(e.mapPidToItems),e.storeNonProducts(t.data.tests||[],t.data.products||[]),e.storeTestsOfExpiredProducts=t.data.paid_tests||[];var a=A(t.data.products);e.storeProducts(a||[],"pack"),e.storeProducts(a||[],"combo"),parseInt(s)!==-1?Q():(e.makeTestIdToTestMap([]),e.getTotalCourseDetails(),u.callDataLayerFunction(),B())}},r=function(e){e?showAlert(e.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)};i.getProductDetails(e.currentCourseId,{},t,r)},Y=function(e){for(var t in e)e[t].validity=e[t]&&e[t].subsId&&u.subsBundleIdToObjMap[e[t].subsId]&&u.subsBundleIdToObjMap[e[t].subsId].validity;return e},V=function(t){var s=function(s){if(s.data&&s.success){e.courseIdToExpiryMap=u.getCourseToExpiryMap(s.data.subscriptions)||{};var r=s.data.subscriptions,a=s.data.attemptedTests||[];u.subsBundleIdToObjMap=getCustomMap(t,"_id","",!0),e.courseIdToExpiryMap=Y(e.courseIdToExpiryMap),e.purchasedSubsMap=u.getPurchasedSubsMap(r)||{};for(var o=0;o<t.length;o++){var n=u.processSubscriptionObject(t[o],e.courseIdToExpiryMap,e.purchasedSubsMap,a);e.subsArr.push(n),e.subsArrMap[n.id]=n||{}}y+=1,2===y&&N(e.studentApiData)}},r=function(e){e?showAlert(e.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)};i.getStuSubsPlan({},s,r)},K=function(){for(var t=0;t<e.subsArr.length;t++){for(var s=!1,r=e.subsArr[t]||{},a=0;a<e.allTestsObj.comboPacks.length;a++)if(e.allTestsObj.comboPacks[a].subsArr||(e.allTestsObj.comboPacks[a].subsArr=[]),e.allTestsObj.comboPacks[a].categoryId===e.subsArr[t].category){s=!0,e.allTestsObj.comboPacks[a].subsArr.push(e.subsArr[t]);break}if(!s){var o=r.category||"",n=e.allCategoryObjById[o]||{},i={categoryId:o,categoryName:n.name||"",categoryOrder:n.order,orderBy:n.sort,sortOrder:n.sortOrder,value:[],subsArr:[r]};e.allTestsObj.comboPacks.push(i)}}},W=function(e){var t={"58c3ea7b995a2d374bb00cbd":"bank-of-baroda-clerk","58c3ea8e995a2d374bb00ccf":"bank-of-maharashtra-clerk","58c3eac6995a2d374bb00d69":"bank-of-maharashtra-po","58e5f60a0328217f0c0aae25":"bank-of-baroda-po","579217c2995a2d588168f9a1":"bsnl-tta","58908740995a2d1564cc2a1e":"coal-india-limited","599ecd0be07ce04e8d481173":"delhi-police-constable","56d83e3e995a2d459a07bcc5":"gate-ce","572334ba995a2d45b2fbb265":"gate-ch","56d83564995a2d459a079b23":"gate-cs","56d83522995a2d459a079a5d":"gate-ec","56d83d739b2dd25c93ff01f0":"gate-ee","57304760995a2d372f19c3d9":"gate-in","56d83558995a2d459a079ae3":"gate-me","572334c9995a2d45b2fbb267":"gate-mt","579760f9995a2d58df9f3060":"rbi-grade-b","59a5a562772444089ebf0d28":"ib-acio","56d6f25d995a2d45a8735a37":"ibps-clerk","56d6f265995a2d45a8735a48":"ibps-po","56d6f2a2995a2d45a8735c12":"ibps-rrb","5854e60803282170d79b07fc":"ibps-so","58c3eb31995a2d374bb00dce":"idbi-so","58481b3c995a2d564c6d3f32":"indian-bank-po","58c3ea9d995a2d374bb00d28":"kvb-clerk","56d6f2be995a2d45a8735c40":"lic-aao","58c3eb58995a2d374bb00e72":"niacl-ao","58bac8d303282167d098c5d1":"niacl-assistant","56d6f2cd995a2d45a8735c42":"nicl-ao","599c11c0b964db0dfcf09ebb":"oicl-ao","56d81119995a2d459a070afe":"placement-aptitude","5989ae366a586643c0b653f1":"railways-rrb-loco-pilot","56d6f29b995a2d45a8735c11":"railway-rrb","5826eb81995a2d36c7e47dbd":"rbi-assistant","58c3eafe995a2d374bb00da1":"repco-bank-po","57dc1c06995a2d66cc9845f6":"rrb-officer-scale-1","56d6f28c995a2d45a8735b95":"sbi-associate-clerk","56d6f283995a2d45a8735b91":"sbi-clerk","56d6f27a995a2d45a8735b49":"sbi-po","58c3eb3f995a2d374bb00e69":"sbi-so","58c3eb47995a2d374bb00e6b":"sidbi-so","58c3eab4995a2d374bb00d60":"south-indian-bank-clerk","58c3eb06995a2d374bb00dbd":"south-indian-bank-po","56d6f293995a2d45a8735bb5":"ssc-cgl","57f7bdfc03282123890789fc":"ssc-chsl","58c37e8503282162000af2cc":"ssc-cpo","5993ff38e5496e0c2bc5f8db":"ssc-imd","57fe2e0903282162c9764941":"ssc-je-mechanical-me","586bae710328217e9e6adcb0":"ssc-mts","5763e3b8995a2d24fe37a9d0":"ssc-stenographer","58c3eb0c995a2d374bb00dc0":"syndicate-bank-po","598d992ecb4e6c0be4dec5ab":"uiic-assistant","58c3eb4d995a2d374bb00e6e":"ubi-so","58c3eb1a995a2d374bb00dc3":"ubi-po","5a0a954912e5d60daaf102f7":"mp-patwari","5a27a1eeeb7b83416de45c63":"gic-assistant-manager","5a377e227c42770f2ed4ef0f":"up-police"};return e&&t[e]||""},X=function(e){var t,s,r,a={},o=[];e=validateArr(e);for(var n=0;n<e.length;n++)t=(new Date).getTime(),r=1e3*e[n].date,s=(t-r)/36e5,a={thumbnailUrl:e[n].full_img,title:e[n].title,url:"//testbook.com/blog/"+e[n].slug,content:e[n].content},s<1?a.timeStampStr="1 hour":s<24?a.timeStampStr=Math.floor(s)+" hours":s<48?a.timeStampStr="1 day":a.timeStampStr=Math.floor(s/24)+" days",o.push(a);return o},G=function(){var t=function(t){t&&t.data&&(e.blogContentArr=X(t.data))},s=function(e){e?showAlert(e.message||"Something went wrong, Please contact at support@testbook.com","error","large",5e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)};i.getBlogPosts(r,!0,t,s)},J=function(){e.allCategoryObjByName={},e.allCategoryObjById={},e.examSlug=W(r),q(),x(),_(),G(),c(function(){O()},0),m()};e.myTestsArr=[],e.attemptedTestsArr=[],e.attemptedCategorizedArr=[],e.resumableTestsArr=[],e.URL_VAL_EXAM_INFO="examInfo",e.URL_VAL_EXAM_PRODUCT_CARDS="exam-product-cards",e.URL_VAL_EXAM_PRACTICE="exam-practice",e.resumableTestsMAP={},e.resumableTestsIdsArr=[],e.hasPractice=$("#hasPractice")&&!!$("#hasPractice").val()||!1,e.isLoading={examInfo:!1},e.blogContentArr=[],e.examSlug="",e.freeTestsCountAdded=0,e.freeTestAddedTitle="",e.isEnrolledInCourse=!1,e.isLoggedIn=isLoggedIn(),e.isReEnroll=!1,e.isEnrollingInCourse=!1,e.currentCourseName=$("#cur-course-title")&&$("#cur-course-title").val()||"",e.currentCourseUrl=$("#curCourseURL")&&$("#curCourseURL").val()||"",e.currentExamName=$("#cur-exam-title")&&$("#cur-exam-title").val()||"",d.setCurrentCourseUrl(e.currentCourseUrl),e.allTestsObj={nonProducts:[],comboPacks:[],packs:[]},e.myProductIds=[],e.testIdToTestMAP={},e.subsArr=[],e.purchasedSubsMap={},e.subsArrMap={},e.courseIdToExpiryMap={},e.totalQuestionsCount=0,e.totalTestsCount=0,e.filteredRenewItems=[],e.isSubscriptionActive=!1,e.examData={},e.currentCourseId=$("#cur-course-id")&&$("#cur-course-id").val()||"",e.freeTestsCountAdded=0,e.freeTestAddedTitle="",e.isShowFreeTestsStatus=!1,e.isExamInfoRestrictedView=!0,e.toggleIsExamInfoRestrictedView=function(t){e.isExamInfoRestrictedView=t},e.setMyTests=function(t,s,r){for(var a=[],o=[],n=0;n<t.length;n++)e.resumableTestsMAP[t[n].id]?(t[n].myCardClass=d.getClassForMyTests(t[n]),t[n].pattern.title="Paused Tests",t[n].pausedTestOrder=e.resumableTestsIdsArr.indexOf(t[n].id),t[n].isResumable=!0,e.resumableTestsArr.push(t[n])):t&&t[n]&&s.indexOf(t[n].id)!==-1?(t[n].isAttempted=!0,t[n].isShow=!0,o.push(t[n])):t&&t[n]&&s.indexOf(t[n].id)!==-1?(t[n].isAttempted=!0,t[n].isShow=!0,o.push(t[n])):(t[n].myCardClass=d.getClassForMyTests(t[n]),a.push(t[n]));if(e.attemptedCategorizedArr=d.getCompleteSortedCategorizedItemsArr(o,"test",!1,"asc"),a.length&&(e.myTestsArr=d.getCompleteSortedCategorizedItemsArr(a,"test",!1,"asc"),g()),e.resumableTestsArr.length&&e.myTestsArr.unshift({categoryId:"-1",categoryName:"Paused Tests",categoryOrder:-1,orderBy:"availFrom",sortOrder:"desc",value:sortFunction(e.resumableTestsArr,"pausedTestOrder","number","asc")}),o.length){var i=e.processAttemptedTests(o,r||[]);e.attemptedTestsArr=e.getSortedAttemptedTestsArr(i,s)}},e.setResumableTests=function(t){var s=t.data.resumableTests||[];e.resumableTestsIdsArr=s;for(var r=0;r<s.length;r++)e.resumableTestsMAP[s[r]]=!0;d.setResumableTestMap(e.resumableTestsMAP)},e.getSortedAttemptedTestsArr=function(e,t){for(var s={},r=[],a=0;a<e.length;a++)s[e[a].id]=e[a];for(var o=0;o<t.length;o++)s[t[o]]&&r.push(s[t[o]]);return r},e.processAllTests=function(){e.allTestsObj.nonProducts=d.resetNonProducts(e.allTestsObj.nonProducts,!0),e.allTestsObj.packs=d.resetPacks(e.allTestsObj.packs,!0),e.allTestsObj.comboPacks=d.resetComboPacks(e.allTestsObj.comboPacks,!0),K()},e.processAttemptedTests=function(e,t){for(var s=function(e,t){return e=e<=t?e:t,Math.floor(e/60)+":"+pad(e%60)},r=0;r<e.length;r++)for(var a=0;a<t.length;a++)e[r].id==t[a].tid&&(e[r].studentAttemptedDetails={},e[r].studentAttemptedDetails.questionsCount=t[a].attempted,e[r].studentAttemptedDetails.correctQuestions=t[a].correctQuestions,e[r].studentAttemptedDetails.marks=Math.round(100*t[a].marks)/100,e[r].studentAttemptedDetails.time=s(t[a].time,60*e[r].testDetails.time),e[r].studentAttemptedDetails.isAttempted=!0,e[r].show_promotions=t[a].show_promotions,e[r].show_result=t[a].show_result);return e},e.enrollInCourse=function(t,s){e.isEnrollingInCourse=!0;var r={courses:t},a=function(){e.isEnrollingInCourse=!1,w(t),showAlert("Successfully enrolled into the course","success","small",5e3),e.isEnrolledInCourse=!0,E(t),s&&s(),forceSessionRefresh(),M(t)},o=function(e){e&&e.message&&""!==e.message?showAlert(e.message,"error","small",3e3):showAlert("Please check your internet connection or contact at support@testbook.com","error","large",5e3)};i.enrollInCourse(r,a,o)},e.showPackCategory=function(e){e=validateArr(e);for(var t=0;t<e.length;t++)if(e&&e[t]&&e[t].isShow&&!e[t].isHide)return!0;return!1},e.searchString=function(e,t){return e.search(t)==-1},e.getTotalCourseDetails=function(){e.totalTestsCount=e.getTotalTestCount(),e.totalQuestionsCount=e.getTotalQuestionsCount()},e.getTotalTestCount=function(){e.myTestsIds=e.myTestsIds&&e.myTestsIds.length&&e.myTestsIds||[];var t=0;for(var s in e.testIdToTestMAP){var r=e.testIdToTestMAP[s];(!r.isPartOfHiddenProduct||r.isPartOfHiddenProduct&&e.myTestsIds.indexOf(r.id)!==-1||r.isPartOfHiddenProduct&&e.myProductIds.indexOf(r.pid)===-1)&&(t+=1)}return t},e.getTotalQuestionsCount=function(){e.myTestsIds=e.myTestsIds&&e.myTestsIds.length&&e.myTestsIds||[];var t=0;for(var s in e.testIdToTestMAP){var r=e.testIdToTestMAP[s];r&&r.testDetails&&(!r.isPartOfHiddenProduct||r.isPartOfHiddenProduct&&e.myTestsIds.indexOf(r.id)!=-1||r.isPartOfHiddenProduct&&e.myProductIds.indexOf(r.id)==-1)&&(t+=r.testDetails.questionsCount)}return t},e.takeMeToUrl=function(t,r){var o;"-1"===s?(o={},o[REDIRECT_URL_KEY]=t,o[COURSE_IDS_KEY]=e.currentCourseId,o[a]="Sign up to take quiz",openSignUpSignInModal(o,!1)):window.location.href=t,U(r)},e.getAllTestIdsAssignedToStudent=function(t){var s=[];if(t.data.tests&&t.data.tests.length&&(s=t.data.tests),t.data.products&&t.data.products.length)for(var r=t.data.products||[],a=0;a<r.length;a++)if(e.myProductIds.indexOf(r[a].pid)===-1&&e.myProductIds.push(r[a].pid),r[a].tests&&r[a].tests.length&&(s=s.concat(r[a].tests)),r[a].products&&r[a].products.length)for(var o=r[a].products||[],n=0;n<o.length;n++)e.myProductIds.indexOf(o[n].pid)===-1&&e.myProductIds.push(o[n].pid),s=s.concat(o[n].tests);return s},e.makeTestIdToTestMap=function(t){var s=[];e.testIdToTestMAP={};for(var r=0;r<e.allTestsObj.nonProducts.length;r++)e.allTestsObj.nonProducts[r].items&&!e.allTestsObj.nonProducts[r].isHide?e.makeTestIdToTestMapHelper(e.allTestsObj.nonProducts[r].items):e.allTestsObj.nonProducts[r].items||e.makeTestIdToTestMapHelper([e.allTestsObj.nonProducts[r]]);for(var r=0;r<e.allTestsObj.packs.length;r++){s=e.allTestsObj.packs[r].value;for(var a=0;a<s.length;a++)s[a].isHide||e.makeTestIdToTestMapHelper(s[a].items)}for(var r=0;r<e.allTestsObj.comboPacks.length;r++){s=e.allTestsObj.comboPacks[r].value;for(var a=0;a<s.length;a++)e.makeTestIdToTestMapHelper(s[a].comboPackTests)}e.makeTestIdToTestMapHelper(t)},e.makeTestIdToTestMapHelper=function(t){if(!t||!t.length)return!1;for(var s=0;s<t.length;s++){var r=t[s];e.testIdToTestMAP[r.id]=r}},e.storeNonProducts=function(t,s){var r,a,o,n,i=t;for(e.freeTestsCount=i.length,r=0;r<s.length;r+=1)if(s[r].items&&1===s[r].items.length&&0===s[r].cost)for(i.push(s[r]),n=s[r].items||[],a=0;a<n.length;a+=1)o=d.getProcessedTestObj(n[a]),e.testIdToTestMAP[o.id]=o;for(r=0;r<i.length;r+=1)i[r]=d.getProcessedTestObj(i[r]);e.allTestsObj.nonProducts=sortFunction(i,"availFrom","number","desc")},e.getFreeTestsArrForCoursesPage=function(e){for(var t=[],s=0;s<e.length;s++)0!=e[s].cost||e[s].isAlreadyPurchased||t.push(e[s]);return t},e.getPacksForCoursesPage=function(t,s){for(var r=[],a=0;a<t.length;a++)t[a].cost>0&&t[a].items&&t[a].items.length>1&&r.push(t[a]);return r=r.concat(e.getArrFromCategoryArr(s))},e.getArrFromCategoryArr=function(e){e=e&&e.length&&e||[];for(var t=[],s=0;s<e.length;s++)for(var r=e[s].value,a=0;a<r.length;a++){var o=r[a];o.isAlreadyPurchased||o.isHide||t.push(o)}return t=t&&t.length&&t||[]},e.triggerEnrollmentPipeline=function(t){var s,r,a=t;a||(a=function(){return window&&(showLoader("Redirecting to mocktest page, Please wait..."),window.location.href="/"+e.currentCourseUrl+"/mocktest?tab=my"),!1}),j(v.enrollments)?a&&a():(e.isReEnroll?(s="Oh! You un-enrolled from the "+e.currentCourseName+" course, you want to re-enroll in the course?",r="Yes, re-enroll"):(s="Oh! We see that you are not enrolled in "+e.currentCourseName+". You need to enroll in the course to add your test",r="Yes, Enroll & add Test"),bootbox.confirm({message:s,buttons:{confirm:{label:r,className:"btn-primary"},cancel:{label:"No",className:"btn-default"}},callback:function(t){t?e.enrollInCourse(e.currentCourseId,a):P=[]}}))},e.parseHtml=function(e){return l.trustAsHtml(S(e))},e.resetMyTestsAfterAddingFreeTests=function(t){var s,r,a,o,n,i=t||[],c={},u=[];for(s=0;s<e.myTestsArr.length;s+=1)for(o=e.myTestsArr[s].value,r=0;r<o.length;r++)i.push(o[r]);for(s=0;s<i.length;s+=1)c[i[s].id]=i[s];for(a in c)c.hasOwnProperty(a)&&u.push(c[a]);return n=d.getCompleteSortedCategorizedItemsArr(u,!1,"fromResetMyTestsAfterAddingFreeTests","asc")},e.setTestsAddedStatus=function(t){e.isShowFreeTestsStatus=t},e.signUpBtnClicked=function(){var t={};t[REDIRECT_URL_KEY]="/"+e.currentCourseUrl+"/mocktest",t[COURSE_IDS_KEY]=e.currentCourseId,t[a]="Sign up for your free test",openSignUpSignInModal(t,!1)},e.addSubsBtnClicked=function(t){var r,o=e.subsArrMap[t]||{};return o.statusClass.search("subs-inactive")!==-1||o.statusClass.search("subs-upgrade")!==-1?"-1"===s?(r={},r[REDIRECT_URL_KEY]="/"+e.currentCourseUrl+"/mocktest?pid="+o.id,r[COURSE_IDS_KEY]=e.currentCourseId,r[a]="Sign up to subscribe courses",openSignUpSignInModal(r,!1)):e.addToCart([o],!0,e.mycoins,!1):o.statusClass.search("subs-expired")!==-1&&e.showRenewSubscriptionModal(o),0},e.addFreeTest=function(t,r,a){function o(e){r&&r(!1)}var n,u,l,p,m,f,b=validateArr(t),T=[],h=[],A=[],C=[];if(parseInt(s)===-1){if(a){var v="/"+e.currentCourseUrl+"/tests/"+e.testToStart.id+"#/interface/q";return window.location=v,0}return n={},n[REDIRECT_URL_KEY]="/"+e.currentCourseUrl+"/mocktest",n[COURSE_IDS_KEY]=e.currentCourseId,openSignUpSignInModal(n,!0),0}if(!b||!b.length||parseInt(s)===-1)return 0;for(e.addFreeTestSCB=function(t){for(hideLoader(),u=0;u<e.allTestsObj.nonProducts.length;u+=1){for(m=!0,l=0;l<b.length;l+=1)if(b[l].id===e.allTestsObj.nonProducts[u].id){m=!1,b[l].myCardClass=d.getClassForMyTests(b[l]),b[l].cardClass=b[l].cardClass?" part-of-my-tests":"part-of-my-tests",setLocalStorageOnLiveTestAdd(b[l].id),C.push(b[l]);break}m&&A.push(e.allTestsObj.nonProducts[u])}e.myTestsArr=e.resetMyTestsAfterAddingFreeTests(C),e.allTestsObj.nonProducts=A,g(),e.freeTestsCountAdded=b.length,e.freeTestAddedTitle=b[0].title,c(function(){e.setTestsAddedStatus(!1)},7e3),r?r(!0):(e.setTestsAddedStatus(!0),showLoader("Redirecting to mocktest page, Please wait..."),window.location.href="/"+e.currentCourseUrl+"/mocktest?tab=my")},e.closeFreeTestAdded=function(){e.setTestsAddedStatus(!1)},u=0;u<b.length;u+=1)b[u].items?h.push(e.getProductObj(b[u])):T.push(b[u].id);p={coins:0,coupon:"",products:h||[],tests:T||[]},p.livetestid="",f={coins:0,coupon:"",ismobile:!1,tests:T.join(",")||[],livetestid:""},showLoader("Adding Free Tests. Please Wait."),i.manageTransactions(f,e.addFreeTestSCB,o)},e.startTestHelper=function(){var t="/"+e.currentCourseUrl+"/tests/"+e.testToStart.id;e.resumableTestsMAP[e.testToStart.id]&&!e.testToStart.isQuiz?t+="#/test":e.testToStart.isQuiz&&(t+="#/interface/q"),window.location=t},e.startQuiz=function(t){e.testToStart=t,e.startTestHelper()},e.addToCart=function(t,r,o,n,i){function d(){P&&P.length&&e.addFreeTest(P)}var c,u,l=t;P=[];var p;if(l[0].cost>0&&parseInt(s)!==-1)return window.location="/"+e.currentCourseUrl+"/mocktest?pid="+l[0].id,0;if(parseInt(s)===-1)return p={},p[REDIRECT_URL_KEY]="/"+e.currentCourseUrl+"/mocktest?pid="+l[0].id+"&tab=my",p[COURSE_IDS_KEY]=e.currentCourseId,i?p[a]="Sign up to take your free test":p[a]="Sign up to buy the tests",openSignUpSignInModal(p,!1),0;for(c=0;c<l.length;c+=1)u=l[c],0===u.cost&&P.push(u);P&&P.length&&e.triggerEnrollmentPipeline(d)},e.initializeCoursePage=function(){e.freeTabClass="",e.packsTabClass="",e.comboTabClass="",e.isShowTabsOnCoursesPage=!1,e.testsArrForCourses=e.getFreeTestsArrForCoursesPage(e.allTestsObj.nonProducts)||[],e.packsArrForCourses=e.getPacksForCoursesPage(e.allTestsObj.nonProducts,e.allTestsObj.packs)||[],e.combosArrForCourses=e.getArrFromCategoryArr(e.allTestsObj.comboPacks)||[];var t=getURLParameterValue("testsTab");t.length?("combo"===t&&(e.comboTabClass="active"),"packs"===t&&(e.packsTabClass="active"),"free"===t&&(e.freeTabClass="active")):e.testsArrForCourses.length?e.freeTabClass="active":e.combosArrForCourses&&e.combosArrForCourses.length||e.subsArr&&e.subsArr.length?e.comboTabClass="active":e.packsArrForCourses&&e.packsArrForCourses.length&&(e.packsTabClass="active"),(e.testsArrForCourses.length||e.packsArrForCourses.length||e.combosArrForCourses.length||h(e.subsArr))&&(e.isShowTabsOnCoursesPage=!0),c(function(){$(".tab-head>li.active").click()},1e3)},e.showComboCategory=function(e,t){e=validateArr(e),t=validateArr(t);for(var s=0;s<e.length;s++)if(e&&e[s]&&e[s].isShow)return!0;for(var s=0;s<t.length;s++)if(t&&t[s]&&t[s].isShow&&t[s].statusClass.search("subs-active")==-1)return!0;return!1},e.showSubReleasePlan=function(e){u.releasePlanBtnClicked(e)},e.showCalculationPlan=function(e){u.calcSavingsBtnClicked(e,e.calcData,e.courseSelectionDS)},e.showRenewSubscriptionModal=function(){e.filteredRenewItems=u.mockTestSubsFilter(e.currentCourseName,e.purchasedSubsMap,e.subsArr),u.renewSubscriptionBtnClicked()},e.storeProducts=function(t,s){for(var r=[],a=0;a<t.length;a++)t[a].cost>0&&r.push(d.getProcessedPackObj(t[a],s));var o=d.getCompleteSortedCategorizedItemsArr(r,s,!1,"asc")||[];"pack"===s.toLowerCase()?e.allTestsObj.packs=sortFunction(o,"categoryOrder","number","asc"):"combo"===s.toLowerCase()&&(e.allTestsObj.comboPacks=sortFunction(o,"categoryOrder","number","asc"),d.setAllTestsObj(e.allTestsObj))},e.showPackInfo=function(t){e.packToShowInfo=t,c(function(){$(".js-bundle-details").addClass("in"),$("body").addClass("modal-open")},50)},e.hideBundleDetails=function(){$(".js-bundle-details").removeClass("in"),$("body").removeClass("modal-open")},$(document).on(enumTBEvents.annBannerAll,function(){p(),m()}),$("#exam-info-headings").on("hidden.bs.collapse shown.bs.collapse",function(){p(),m()}),e.$on("NG_EXAM_INFO_RENDERED",function(){initScrollToAnchorHref(),p(),m();var t=getURLParameterValue("loc");""!==t&&"info-"===t.substring(0,5)?(e.toggleIsExamInfoRestrictedView(!1),c(function(){scrollToLoc(n+10)})):c(function(){scrollToLoc(n+10)})}),J(),e.addPacksToMyTestsViaSubscription=function(t,s){function r(r){var a,o,n,i,u=[];for(a=0;a<t.items.length;a+=1)if("test"===t.items[a].type.toLowerCase())t.items[a].myCardClass=d.getClassForMyTests(t.items[a]),u.push(t.items[a]);else if("product"===t.items[a].type.toLowerCase())for(n=t.items[a].id,i=validateArr(e.mapPidToProduct[n]&&e.mapPidToProduct[n].items),o=0;o<i.length;o+=1)i[o].myCardClass=d.getClassForMyTests(i[o]),u.push(i[o]);s.splice(s.indexOf(t),1),e.myTestsArr=e.resetMyTestsAfterAddingFreeTests(u),hideLoader(),e.setTestsAddedStatus(!0),c(function(){e.setTestsAddedStatus(!1)},7e3)}function a(e){hideLoader(),showAlert(e.message||"Something went wrong, Please try again.","error","sm",3e3)}showLoader("Adding Tests To Your Account Please Wait."),i.addPacksToMyTestsViaSubscription({pid:t.id},r,a)}}var t=TB||{},s=$("#sid")&&$("#sid").val()||-1,r=$("#cur-exam-id")&&$("#cur-exam-id").val()||"",a="headerText",o="REMOVE_STU_COURSE_DROPDOWN",n=52;angular.module("examApp",["tbHeaderApp","practiceChapterWidgetApp","productCardModule","renderFinishModule","SEO"]).controller("examController",["$scope","TB","productCardService","$timeout","subscriptionService","$sce",e])}();