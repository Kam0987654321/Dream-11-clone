var app=angular.module("TestService",[]);app.service("testService",["$http","$sce","$timeout",function(t,e,r){this.languages=[{name:"en",prompt:"English"},{name:"hn",prompt:"Hindi"}],this.alert=function(t){bootbox.alert({message:t,buttons:{ok:{label:"Ok",className:"btn-test-primary"}}})},this.isValidAnswers=function(t){return!(0===Object.getOwnPropertyNames(t).length)},this.getSID=function(){return $("#sid")&&$("#sid").val()||""},this.htmlspecialchars_decode=function(t){return"string"==typeof t&&(t=t.replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&#039;/g,"'").replace(/&quot;/gi,'"').replace(/&amp;/gi,"&")),t},this.specialCharsDecodeToString=function(t){return t.replace(/<\/?[^>]+(>|$)/g,"").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#8758;/g,":").replace(/&nbsp;/g," ")},this.checkForGateAndNonGateInstructions=function(){var t=($("#courseTitle").val()||"").toLowerCase();return t.indexOf("gate")!=-1},this.getPosMarks=function(t,e){return t[e-1].posMarks},this.getNegMarks=function(t,e){return t[e-1].negMarks},this.hasComprehension=function(t,e,r){var n=t[e-1],i=n[r]&&n[r].comp&&""!=n[r].comp;if(!i&&this.isTranslationPresent(t,e,r)){var o=this.flipLanguage(r);return n=t[e-1],n[o.name].comp&&""!=n[o.name].comp}return i},this.flipLanguage=function(t){return t==this.languages[0].name?this.languages[1]:this.languages[0]},this.isTranslationPresent=function(t,e,r){var n=t[e-1],i=this.flipLanguage(r);return n[i.name]&&n[i.name].value&&""!=n[i.name].value},this.isNumerical=function(t,e){return t[e-1].isNum},this.getComprehension=function(t,e,r){var n=t[e-1][r].comp;if((!n||""==n)&&this.isTranslationPresent(t,e,r)){var i=this.flipLanguage(r);n=t[e-1][i.name].comp}return this.parseHTML(n)},this.getQuestionDesc=function(t,e,r,n){var i=t[e-1][r].value;if((!i||""==i)&&this.isTranslationPresent(t,e,r)){var o=this.flipLanguage(r);i=t[e-1][o.name].value}return n&&(i=i.substr(0,n)),this.parseHTML(i,"Translation for this question is not available")},this.getOptions=function(t,e,r){var n=t[e-1][r].options||[];if(0==n.length){var i=this.flipLanguage(r);n=t[e-1][i.name].options||[]}return n},this.getQID=function(t,e){return t[e-1]._id},this.getSolutionDesc=function(t,e,r,n){var i=this.getQID(t,r),o=e[i]&&this.parseHTML(e[i].sol[n].value)||"";if(""==o){var s=this.flipLanguage(n);o=e[i]&&this.parseHTML(e[i].sol[s.name].value)||""}return o},this.parseHTML=function(t,r){return t&&""!=t||(t=r?r:""),e.trustAsHtml(this.htmlspecialchars_decode(t))},this.getCorrectOption=function(t,e,r){var n=this.getQID(t,r);return e[n]&&e[n].correctOption},this.getNumericalAnswer=function(t,e,r){var n=this.getQID(t,r);if(e[n]&&e[n].range){var i=e[n].range;return{upperLimit:i.end,lowerLimit:i.start}}return{upperLimit:"",lowerLimit:""}},this.getStudentResponseForNum=function(t,e,r){var n=this.getQID(e,r);return t[n]&&t[n].markedOption||"Not Attempted"},this.isCorrectOption=function(t,e,r,n){var i=this.getQID(t,r);return e[i]&&e[i].correctOption==n.prompt},this.isIncorrectOption=function(t,e,r,n,i){var o=this.getQID(e,n);return(!r[o]||"-1"!=r[o].correctOption)&&(t[o]&&t[o].markedOption==i.prompt&&r[o]&&r[o].correctOption!=i.prompt)},this.hasAttempted=function(t){return""!=t&&Number(t)==t},this.isNumCorrect=function(t,e,r){var n=[t[e].range.start,t[e].range.end];if(this.hasAttempted(r)&&2==n.length){r=Number(r);var i=Number(n[0]),o=Number(n[1]);return i<=r&&r<=o}return!1},this.isIncorrect=function(t,e,r,n){var i=this.getQID(e,n);if(r[i]&&"-1"==r[i].correctOption)return!1;if(!r[i]||""!=r[i].correctOption&&r[i].correctOption||!t[i])return t[i]&&r[i]&&null!=t[i].markedOption&&""!=t[i].markedOption&&t[i].markedOption!=r[i].correctOption;var o=t[i].markedOption;return this.hasAttempted(o)&&!this.isNumCorrect(i,o)},this.isCorrect=function(t,e,r,n){var i=this.getQID(e,n);if(t[i]&&r[i]&&"-1"==r[i])return!0;if(!r[i]||""!=r[i].correctOption&&r[i].correctOption||!t[i])return t[i]&&r[i]&&t[i].markedOption==r[i].correctOption;var o=t[i].markedOption;return this.hasAttempted(o)&&this.isNumCorrect(i,o)},this.getDefaultTest=function(){return{title:"Loading...",sectionTimeSharedFlag:!0,sections:[{title:"Section 1",qCount:2,questions:[{_id:"558db1c62a396511d048dbe1",isNum:!1,comp:"",posMarks:4,negMarks:1,en:{value:"question description come here - 1",options:[{prompt:"1",value:"1- option 1"},{prompt:"2",value:"1- option 2"},{prompt:"3",value:"1- option 3"},{prompt:"4",value:"1- option 4"}]},hn:{}},{_id:"558db1c62a396511d048dbe1",isNum:!1,comp:"",posMarks:4,negMarks:1,en:{value:"question description come here - 2",options:[{prompt:"1",value:"2- option 1"},{prompt:"2",value:"2- option 2"},{prompt:"3",value:"2- option 3"},{prompt:"4",value:"2- option 4"}]},hn:{}}]}]}},this.confirm=function(t,e){bootbox.confirm({message:t,buttons:{confirm:{label:"Yes",className:"btn-test-primary"},cancel:{label:"No",className:"btn-gray-1"}},callback:function(t){r(function(){e(t)},250,!0)}})}}]);